read_delim(here::here("database", "WID", "WID_data_RO.csv")) %>% filter(variable=="sptincj992") %>% filter(year==2021) %>% filter(country=="RO") %>% select(percentile, value)
distrib_wid <- read_delim(here::here("database", "WID", "WID_data_RO.csv")) %>%
filter(variable=="sptincj992") %>% filter(year==2021) %>%
filter(country=="RO") %>% select(percentile, value)
distrib_wid <- read_delim(here::here("database", "WID", "WID_data_RO.csv")) %>%
filter(variable=="sptincj992") %>% filter(year==2021) %>%
filter(country=="RO") %>% select(percentile, value)
pe <- numeric(100)
for(i in 1:100){
pe[i] <- paste0("p", i-1, "p", i)
}
pe
distrib_wid <- read_delim(here::here("database", "WID", "WID_data_RO.csv")) %>%
filter(variable=="sptincj992") %>% filter(year==2021) %>%
filter(country=="RO") %>% select(percentile, value)
pe <- numeric(100)
for(i in 1:100){
pe[i] <- paste0("p", i-1, "p", i)
}
distrib_wid <- distrib_wid %>% filter(percentile%in%pe)
distrib_wid
distrib_wid$value %>% barplot()
pe
distrib_wid %>% filter(percentile%in%pe) %>% mutate(percentile = as.factor(percentile)) %>% mutate(percentile = fct_relevel(percentile, after = pe))
distrib_wid %>% filter(percentile%in%pe) %>% mutate(percentile = as.factor(percentile)) %>% mutate(percentile = fct(percentile, levels=pe))
distrib_wid %>% filter(percentile%in%pe) %>% mutate(percentile = fct(percentile, levels=pe))
distrib_wid %>% filter(percentile%in%pe) %>% mutate(percentile = as.factor(percentile)) %>% mutate(percentile = fct(percentile, levels=pe, ordered=T))
distrib_wid %>% filter(percentile%in%pe) %>% mutate(percentile = as.factor(percentile)) %>% mutate(percentile = factor(percentile, levels=pe, ordered=T))
distrib_wid %>% filter(percentile%in%pe) %>% mutate(percentile = as.factor(percentile)) %>% mutate(percentile = factor(percentile, levels=pe, ordered=T)) %>% arrange(percentile)
distrib_wid <- read_delim(here::here("database", "WID", "WID_data_RO.csv")) %>%
filter(variable=="sptincj992") %>% filter(year==2021) %>%
filter(country=="RO") %>% select(percentile, value)
pe <- numeric(100)
for(i in 1:100){
pe[i] <- paste0("p", i-1, "p", i)
}
distrib_wid <- distrib_wid %>% filter(percentile%in%pe) %>%
mutate(percentile = as.factor(percentile)) %>%
mutate(percentile = factor(percentile, levels=pe, ordered=T)) %>%
arrange(percentile)
distrib_wid$value %>% barplot()
distrib_wid$value %
distrib_wid$value
raport_wid <- function(coefs, k){
((coefs[1])*sum(distrib_wid$value[1:k]) +
(coefs[2])*sum(distrib_wid$value[(k+1):10]))/(0.1*sum(distrib_wid$value[1:k]) +
0.1*sum(distrib_wid$value[(k+1):10]))
}
raport_wid(coefs=c(0.16, 0.21), k=92)
distrib
raport_wid(coefs=c(0.16, 0.21), k=92)
raport_wid(coefs=c(0.16, 0.21), k=9)
raport_wid(coefs=c(0.16, 0.21), k=92)
raport_wid(coefs=c(0.16, 0.21), k=99)
raport_wid(coefs=c(0.16, 0.21), k=1)
raport_wid(coefs=c(0.16, 0.21), k=9)
raport_wid(coefs=c(0.16, 0.21), k=8)
raport_wid(coefs=c(0.16, 0.21), k=9)
distrib_wid <- read_delim(here::here("database", "WID", "WID_data_RO.csv")) %>%
filter(variable=="sptincj992") %>% filter(year==2021) %>%
filter(country=="RO") %>% select(percentile, value)
pe <- numeric(100)
for(i in 1:100){
pe[i] <- paste0("p", i-1, "p", i)
}
distrib_wid <- distrib_wid %>% filter(percentile%in%pe) %>%
mutate(percentile = as.factor(percentile)) %>%
mutate(percentile = factor(percentile, levels=pe, ordered=T)) %>%
arrange(percentile)
raport_wid <- function(coefs, k){
((coefs[1])*sum(distrib_wid$value[1:k]) +
(coefs[2])*sum(distrib_wid$value[(k+1):100]))/(0.1*sum(distrib_wid$value[1:k]) +
0.1*sum(distrib_wid$value[(k+1):100]))
}
raport_wid(coefs=c(0.16, 0.21), k=92)
raport_wid(coefs=c(0.16, 0.21), k=92)
raport_wid(coefs=c(0.16, 0.21), k=93)
raport_wid(coefs=c(0.16, 0.21), k=9)
raport_wid(coefs=c(0.16, 0.21), k=93)
raport_wid(coefs=c(0.16, 0.21), k=99)
raport_wid(coefs=c(0.16, 0.21), k=92)
raport(coefs = c(0.16, 0.21), k=1)
raport(coefs = c(0.16, 0.21), k=2)
raport(coefs = c(0.16, 0.21), k=9)
71.8*28/100
5*0.7
insumari <- read_csv(here::here("database", "taxe_sectoriale_scutiri.csv")) %>%
mutate(sector=str_to_upper(sector)) %>%
group_by(sector) %>% summarise(valoare=sum(valoare)) %>%
rename(Masura = sector, Impact=valoare) %>%
bind_rows(tibble("Masura"=c("Impozit progresiv pe venit",
"Impozit pe dividende",
"Tranzacţii imobiliare"),
"Impact"=c(20, 6, 0.35))) %>%
mutate(sector = c("Eliminare scutiri", "Eliminare scutiri", "Taxe sectoriale", "Eliminare scutiri", "Taxe sectoriale", "Taxe sectoriale", "Creştere impozite", "Creştere impozite", "Taxe sectoriale")) %>%
relocate(sector)
library(tidyverse)
insumari <- read_csv(here::here("database", "taxe_sectoriale_scutiri.csv")) %>%
mutate(sector=str_to_upper(sector)) %>%
group_by(sector) %>% summarise(valoare=sum(valoare)) %>%
rename(Masura = sector, Impact=valoare) %>%
bind_rows(tibble("Masura"=c("Impozit progresiv pe venit",
"Impozit pe dividende",
"Tranzacţii imobiliare"),
"Impact"=c(20, 6, 0.35))) %>%
mutate(sector = c("Eliminare scutiri", "Eliminare scutiri", "Taxe sectoriale", "Eliminare scutiri", "Taxe sectoriale", "Taxe sectoriale", "Creştere impozite", "Creştere impozite", "Taxe sectoriale")) %>%
relocate(sector)
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#afe111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_body()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_stub()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_summary()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_stub_summary()) %>%
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura, rows=c(rep(FALSE, 4), TRUE, rep(FALSE, 3)))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura, rows=c(rep(FALSE, 5), TRUE, rep(FALSE, 2)))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura, rows=c(rep(FALSE, 6), TRUE, FALSE))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura, rows=c(rep(FALSE, 7), TRUE)))
library(gt)
insumari <- read_csv(here::here("database", "taxe_sectoriale_scutiri.csv")) %>%
mutate(sector=str_to_upper(sector)) %>%
group_by(sector) %>% summarise(valoare=sum(valoare)) %>%
rename(Masura = sector, Impact=valoare) %>%
bind_rows(tibble("Masura"=c("Impozit progresiv pe venit",
"Impozit pe dividende",
"Tranzacţii imobiliare"),
"Impact"=c(20, 6, 0.35))) %>%
mutate(sector = c("Eliminare scutiri", "Eliminare scutiri", "Taxe sectoriale", "Eliminare scutiri", "Taxe sectoriale", "Taxe sectoriale", "Creştere impozite", "Creştere impozite", "Taxe sectoriale")) %>%
relocate(sector)
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#afe111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_body()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_stub()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_summary()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_stub_summary()) %>%
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura, rows=c(rep(FALSE, 4), TRUE, rep(FALSE, 3)))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura, rows=c(rep(FALSE, 5), TRUE, rep(FALSE, 2)))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura, rows=c(rep(FALSE, 6), TRUE, FALSE))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura, rows=c(rep(FALSE, 7), TRUE)))
insumari <- read_csv(here::here("database", "taxe_sectoriale_scutiri.csv")) %>%
mutate(sector=str_to_upper(sector)) %>%
group_by(sector) %>% summarise(valoare=sum(valoare)) %>%
rename(Masura = sector, Impact=valoare) %>%
bind_rows(tibble("Masura"=c("Impozit progresiv pe venit",
"Impozit pe dividende",
"TRANZACŢII IMOBILIARE"),
"Impact"=c(20, 6, 0.35))) %>%
mutate(sector = c("Eliminare scutiri", "Eliminare scutiri", "Taxe sectoriale", "Eliminare scutiri", "Taxe sectoriale", "Taxe sectoriale", "Creştere impozite", "Creştere impozite", "Taxe sectoriale")) %>%
relocate(sector)
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#afe111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_body()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_stub()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_summary()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_stub_summary()) %>%
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="10 % taxă pe tranzacţiile imobiliare",
locations=cells_body(columns=Masura,
rows=grepl("IMOBILIARE", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura,
rows=grepl("JOCURI", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura,
rows=grepl("RETAIL", Masura))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura,
rows=grepl("venit", Masura))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura,
rows=grepl("dividende", Masura)))
insumari
insumari %>% mutate(index = c(1, 2, 3, 6, 7, 8, 5, 4)) %>%
arrange(desc(index)) %>%
mutate(procent = 100*Impact/sum(Impact),
ypos=cumsum(procent)-0.5*procent,
eticheta = paste0(round(procent, 2), " %")) %>%
ggplot(aes(x = 1.8, y = procent, fill = Masura)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta="y", start = 0, direction=1)+
geomtextpath::geom_textpath(aes(y = ypos,
label = eticheta), color = "white")+
scale_fill_manual(values=c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF",
"seagreen4", "red3", "royalblue4", "orange3")) +
theme_void() +
xlim(0.5, 2.5)
insumari %>% mutate(index = c(1, 2, 3, 6, 7, 8, 5, 4, 9)) %>%
arrange(desc(index)) %>%
mutate(procent = 100*Impact/sum(Impact),
ypos=cumsum(procent)-0.5*procent,
eticheta = paste0(round(procent, 2), " %")) %>%
ggplot(aes(x = 1.8, y = procent, fill = Masura)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta="y", start = 0, direction=1)+
geomtextpath::geom_textpath(aes(y = ypos,
label = eticheta), color = "white")+
scale_fill_manual(values=c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF",
"seagreen4", "red3", "royalblue4", "orange3", "#000")) +
theme_void() +
xlim(0.5, 2.5)
insumari %>% mutate(index = c(1, 2, 3, 6, 7, 8, 5, 4, 9)) %>%
arrange(desc(index)) %>%
mutate(procent = 100*Impact/sum(Impact),
ypos=cumsum(procent)-0.5*procent,
eticheta = paste0(round(procent, 2), " %")) %>%
ggplot(aes(x = 1.8, y = procent, fill = Masura)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta="y", start = 0, direction=1)+
geomtextpath::geom_textpath(aes(y = ypos,
label = eticheta), color = "white")+
scale_fill_manual(values=c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF",
"seagreen4", "red3", "royalblue4", "orange3", "black")) +
theme_void() +
xlim(0.5, 2.5)
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bf1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_body()) %>%
tab_style(style=cell_fill(color="#efefef"), locations=cells_stub()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_summary()) %>%
tab_style(style=cell_fill(color="#aaaaaa"), locations=cells_stub_summary()) %>%
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="10 % taxă pe tranzacţiile imobiliare",
locations=cells_body(columns=Masura,
rows=grepl("IMOBILIARE", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura,
rows=grepl("JOCURI", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura,
rows=grepl("RETAIL", Masura))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura,
rows=grepl("venit", Masura))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura,
rows=grepl("dividende", Masura))) %>% gtsave("tabel_insumat_total.png")
library(tidyverse)
library(gt)
library(TEMPO)
theme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 16,
strip_text_family = "Roboto Condensed",
strip_text_face = "italic",
axis_title_size = 12))
firme <- read_csv(here::here("database", "bl_bs_sl+ir+uu.csv")) %>%
select(cui, caen, cifra_afaceri=cifra_de_afaceri_neta,
profit_net, pierdere_neta, salariati=numar_mediu_de_salariati,
categorie) %>% mutate(caen=as.character(caen))
insumat <- sume_alimentar %>% mutate(sector="Alimentar & Agricultura") %>%
select(sector, caen, valoare=sume) %>%
bind_rows(sume_constructii %>% mutate(sector="Construcţii") %>%
select(sector, caen, valoare=sume),
sume_energie %>% mutate(sector="Energie"),
sume_it %>% mutate(sector="IT") %>% select(sector, caen, valoare=sume),
sume_jocuri %>% mutate(sector="Jocuri de noroc"),
sume_retail %>% mutate(sector="Retail"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list("TOTAL"="sum")) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list("TOTAL"="sum")) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=VALOARE, fns=list(TOTAL= ~sum)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL= ~sum)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color="#ccc444"), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color="#ccc444"), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color="#1f1f1f"), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color="#bd1111"), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL")) %>% gtsave("tabel_insumat_profit.png")
