scale_size_continuous(range=c(2, 4)) +
labs(title="Deficitul bugetar", subtitle="Media 2012-2022",
size=NULL, colour="Sold bugetar", caption="Sursa: Eurostat, gov_10a_main")
ggplot(db %>% filter(geo!="Romania"),
aes(x=`Venituri totale`, y=`Cheltuieli totale`)) +
geom_point(aes(colour=index)) +
ggrepel::geom_text_repel(aes(label=geo, size=abs(deficit),
colour=index),
show.legend = c("size"=FALSE)) +
ggtext::geom_richtext(data=db%>% filter(geo=='Romania'),
aes(x=`Venituri totale`, y=`Cheltuieli totale`,
label="<b>Romania</b>"),
fill=NA, label.color=NA) +
geom_abline(slope=1, intercept=0, linetype=2) +
scale_colour_manual(values=culori[c(1, 5)]) +
scale_x_continuous(labels=scales::percent_format(scale=1)) +
scale_y_continuous(labels=scales::percent_format(scale=1)) +
scale_size_continuous(range=c(2, 4)) +
labs(title="Deficitul bugetar", subtitle="Media 2012-2022",
size=NULL, colour="Sold bugetar", caption="Sursa: Eurostat, gov_10a_main")
ggplot(db,
aes(x=`Venituri totale`, y=`Cheltuieli totale`)) +
geom_point(aes(colour=index)) +
ggrepel::geom_text_repel(data=db %>%filter(geo!="Romania"),
aes(label=geo, size=abs(deficit),
colour=index),
show.legend = c("size"=FALSE)) +
ggtext::geom_richtext(data=db%>% filter(geo=='Romania'),
aes(x=`Venituri totale`, y=`Cheltuieli totale`,
label="<b>Romania</b>"),
fill=NA, label.color=NA) +
geom_abline(slope=1, intercept=0, linetype=2) +
scale_colour_manual(values=culori[c(1, 5)]) +
scale_x_continuous(labels=scales::percent_format(scale=1)) +
scale_y_continuous(labels=scales::percent_format(scale=1)) +
scale_size_continuous(range=c(2, 4)) +
labs(title="Deficitul bugetar", subtitle="Media 2012-2022",
size=NULL, colour="Sold bugetar", caption="Sursa: Eurostat, gov_10a_main")
ggplot(db,
aes(x=`Venituri totale`, y=`Cheltuieli totale`)) +
geom_point(aes(colour=index)) +
ggrepel::geom_text_repel(data=db %>%filter(geo!="Romania"),
aes(label=geo, size=abs(deficit),
colour=index),
show.legend = c("size"=FALSE)) +
ggtext::geom_richtext(data=db%>% filter(geo=='Romania'),
aes(x=`Venituri totale`, y=`Cheltuieli totale`,
label="<b>Romania</b>"),
fill=NA, label.color=NA, nudge_y = 1) +
geom_abline(slope=1, intercept=0, linetype=2) +
scale_colour_manual(values=culori[c(1, 5)]) +
scale_x_continuous(labels=scales::percent_format(scale=1)) +
scale_y_continuous(labels=scales::percent_format(scale=1)) +
scale_size_continuous(range=c(2, 4)) +
labs(title="Deficitul bugetar", subtitle="Media 2012-2022",
size=NULL, colour="Sold bugetar", caption="Sursa: Eurostat, gov_10a_main")
agregate %>% filter(grepl("Total general", na_item)) %>%
mutate(na_item = gsub("^.+expenditure$", "Cheltuieli totale", na_item) %>%
gsub("^.+revenue", "Venituri totale", .)) %>%
mutate(time=lubridate::year(time)) %>% filter(time>2011) %>%
group_by(geo, na_item) %>% summarise(values=mean(values)) %>%
ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%
mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>%
arrange((Balanta)) %>% filter(row_number()<11) %>%
rename("Ţări"=geo) %>% gt::gt() %>%
gt::fmt_number(columns=2:4, decimals = 2) %>%
gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE,
accounting = FALSE) %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare") %>%
gt::tab_style(style = gt::cell_fill(color=culori[5]),
locations = gt::cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gt::tab_caption("Sursa: calcule pe Eurostat, gov_10a_main") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gtExtras::gt_highlight_rows(rows=6)
agregate %>% filter(grepl("Total general", na_item)) %>%
mutate(na_item = gsub("^.+expenditure$", "Cheltuieli totale", na_item) %>%
gsub("^.+revenue", "Venituri totale", .)) %>%
mutate(time=lubridate::year(time)) %>% filter(time>2011) %>%
group_by(geo, na_item) %>% summarise(values=mean(values)) %>%
ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%
mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>%
arrange((Balanta)) %>% filter(row_number()<11) %>%
rename("Ţări"=geo) %>% gt::gt() %>%
gt::fmt_number(columns=2:4, decimals = 2) %>%
gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE,
accounting = FALSE) %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare",
subtitle="Sursa: calcule pe Eurostat, gov_10a_main") %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gtExtras::gt_highlight_rows(rows=6)
agregate %>% filter(grepl("Total general", na_item)) %>%
mutate(na_item = gsub("^.+expenditure$", "Cheltuieli totale", na_item) %>%
gsub("^.+revenue", "Venituri totale", .)) %>%
mutate(time=lubridate::year(time)) %>% filter(time>2011) %>%
group_by(geo, na_item) %>% summarise(values=mean(values)) %>%
ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%
mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>%
arrange((Balanta)) %>% filter(row_number()<11) %>%
rename("Ţări"=geo) %>% gt::gt() %>%
gt::fmt_number(columns=2:4, decimals = 2) %>%
gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE,
accounting = FALSE) %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare",
subtitle="Sursa: calcule pe Eurostat, gov_10a_main") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gtExtras::gt_highlight_rows(rows=6)
agregate %>% filter(grepl("Total general", na_item)) %>%
mutate(na_item = gsub("^.+expenditure$", "Cheltuieli totale", na_item) %>%
gsub("^.+revenue", "Venituri totale", .)) %>%
mutate(time=lubridate::year(time)) %>% filter(time>2011) %>%
group_by(geo, na_item) %>% summarise(values=mean(values)) %>%
ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%
mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>%
arrange((Balanta)) %>% filter(row_number()<11) %>%
rename("Ţări"=geo) %>% gt::gt() %>%
gt::fmt_number(columns=2:4, decimals = 2) %>%
gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE,
accounting = FALSE) %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare",
subtitle="Sursa: calcule pe Eurostat, gov_10a_main") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger Light") %>%
gtExtras::gt_highlight_rows(rows=6)
agregate %>% filter(grepl("Total general", na_item)) %>%
mutate(na_item = gsub("^.+expenditure$", "Cheltuieli totale", na_item) %>%
gsub("^.+revenue", "Venituri totale", .)) %>%
mutate(time=lubridate::year(time)) %>% filter(time>2011) %>%
group_by(geo, na_item) %>% summarise(values=mean(values)) %>%
ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%
mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>%
arrange((Balanta)) %>% filter(row_number()<11) %>%
rename("Ţări"=geo) %>% gt::gt() %>%
gt::fmt_number(columns=2:4, decimals = 2) %>%
gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE,
accounting = FALSE) %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare",
subtitle="Sursa: calcule pe Eurostat, gov_10a_main") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger Bold") %>%
gtExtras::gt_highlight_rows(rows=6)
agregate %>% filter(grepl("Total general", na_item)) %>%
mutate(na_item = gsub("^.+expenditure$", "Cheltuieli totale", na_item) %>%
gsub("^.+revenue", "Venituri totale", .)) %>%
mutate(time=lubridate::year(time)) %>% filter(time>2011) %>%
group_by(geo, na_item) %>% summarise(values=mean(values)) %>%
ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%
mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>%
arrange((Balanta)) %>% filter(row_number()<11) %>%
rename("Ţări"=geo) %>% gt::gt() %>%
gt::fmt_number(columns=2:4, decimals = 2) %>%
gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE,
accounting = FALSE) %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare",
subtitle="Sursa: calcule pe Eurostat, gov_10a_main") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger Light") %>%
gtExtras::gt_highlight_rows(rows=6)
library(tidyverse)
library(gt)
theme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14,
strip_text_family = "Frutiger Bold",
axis_title_size = 10,
axis_text_size = 8,
base_family = "Frutiger",
plot_title_family = "Frutiger Bold",
subtitle_family = "Frutiger",
caption_family = "Frutiger",
caption_size = 8,
plot_title_size = 14,
subtitle_size = 10) +
theme(legend.text = element_text(size=8),
legend.title = element_text(size=10),
legend.key.size = unit(0.5, "cm")))
culori <- c("#EA5B0C", "#a44a08", "#ea960c", "#ea150c",
"#a40e08", "#000000", "#0865a4", "#a48408")
library(tidyverse)
library(gt)
library(TEMPO)
culori <- c("#EA5B0C", "#a44a08", "#ea960c", "#ea150c",
"#a40e08", "#000000", "#0865a4", "#a48408")
theme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14,
strip_text_family = "Frutiger Bold",
axis_title_size = 10,
axis_text_size = 8,
base_family = "Frutiger",
plot_title_family = "Frutiger Bold",
subtitle_family = "Frutiger",
caption_family = "Frutiger",
caption_size = 8,
plot_title_size = 14,
subtitle_size = 10) +
theme(legend.text = element_text(size=8),
legend.title = element_text(size=10),
legend.key.size = unit(0.5, "cm")))
firme <- read_csv(here::here("database", "bl_bs_sl+ir+uu.csv")) %>%
select(cui, caen, cifra_afaceri=cifra_de_afaceri_neta,
profit_net, profit_brut, pierdere_neta,
salariati=numar_mediu_de_salariati,
categorie) %>% mutate(caen=as.character(caen))
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]), locations=cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_title()) %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gt::tab_style(style=cell_fill(color=culori[5]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels())
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gt::tab_style(style=cell_fill(color=culori[5]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels())
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .))
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gt::tab_style(style=cell_fill(color=culori[5]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels())
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger") %>%
gt::tab_style(style=cell_fill(color=culori[5]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels())
gt(df_fosili) %>%
tab_header(title = "Impozit colectat teoretic (milioane RON)",
subtitle="Scenariul spaniol şi cel propus") %>%
gt::fmt_number(columns = 3:4, decimals = 2) %>%
gt::grand_summary_rows(3:4, fns = list(Total=~sum(.))) %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font='Frutiger')
gt(df_fosili) %>%
tab_header(title = "Impozit colectat teoretic (milioane RON)",
subtitle="Scenariul spaniol şi cel propus") %>%
gt::fmt_number(columns = 3:4, decimals = 2) %>%
gt::grand_summary_rows(3:4, fns = list(Total=~sum(.))) %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font='Frutiger') %>%
gt::tab_style(cell_fill(color=culori[1]), cells_column_labels())
map_dbl(c(0, 1000000, 10000000, 100000000),
~calculeaza(CAEN="92..", procent=0.012, prag=.x)) %>%
enframe(.) %>% select(-name) %>%
mutate(name=c("Toate", "1 milion", "10 milioane", "100 milioane")) %>%
relocate(name) %>% rename(Prag=name, Valoare=value) %>%
gt() %>%
tab_header("Impozit colectat de la jocurile de noroc", subtitle="Milioane RON") %>%
gt::fmt_number(columns=2, decimals=2) %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font='Frutiger') %>%
gt::tab_style(cell_fill(color=culori[1]), cells_column_labels())
gt::gt(sume_it) %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font='Frutiger') %>%
gt::tab_style(cell_fill(color=culori[1]), cells_column_labels())
gt::gt(sume_it) %>%
gtExtras::gt_theme_538() %>%
gt::opt_table_font(font='Frutiger') %>%
gt::tab_style(cell_fill(color=culori[1]), cells_column_labels()) %>%
gt::fmt_number(columns=3:4)
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL")) %>% gtExtras::gt_theme_538() %>%
gt::opt_table_font(font="Frutiger")
??import_font
??import_font()
??font_import
extrafont::fonts()
extrafont::choose_font()
extrafont::font_import(path="/home/petre/.local/share/fonts/")
extrafont::font_import(path="/home/petre/.local/share/fonts")
extrafont::font_import(path="/home/petre/.local/share/fonts/FrutigerLTCom-Light.ttf")
extrafont::font_import(path="/home/petre/.local/share/fonts/FrutigerLTCom-Light.ttf")
extrafont::font_import(path="/home/petre/.local/share/fonts")
extrafont::font_import(path="/home/petre/.local/share/fonts/")
y
font_import(path="/home/petre/.local/share/fonts/")
library(extrafont)
font_import(path="/home/petre/.local/share/fonts/")
loadfonts()
font_import()
loadfonts()
fonttable()
fonttable()
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538()
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>% opt_table_font(font="Frutiger")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger Light")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger Light")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels())# %>%
#gt::opt_table_font(font="Frutiger Light")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger Bold")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger Bold")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger")
firme %>% mutate(impozit=profit_brut-profit_net) %>%
group_by(categorie) %>%
summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>%
mutate(categorie = gsub("_an2021.txt|web_", "", categorie)) %>%
mutate(categorie = gsub("bl_bs_sl", "Plătitoare de CIT", categorie) %>%
gsub("ir", "Plătitoare de CIT (bilanţ IFRS)", .) %>%
gsub("uu", "Microîntreprinderi", .)) %>%
gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>%
gt::tab_header(title="Rata de taxare efectivă în 2021",
subtitle="Sursa: situaţiile financiare de pe data.gov.ro") %>%
gtExtras::gt_theme_538() %>%
gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=cells_column_labels()) %>%
gt::opt_table_font(font="Frutiger")
