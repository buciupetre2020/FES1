read_csv("https://raw.githubusercontent.com/pierrebachas/Globalization_Factor_Taxation/main/globalETR_bfjz.csv") %>%
select(country_name, year, region, ETR_L, ETR_K) %>%
filter(country_name%in%c("Romania", "Hungary", "Bulgaria", "Poland")) %>%
gather(ETR_L:ETR_K, key="tax_rate", value='valoare') %>%
mutate(country_name=gsub("Poland", "Polonia", country_name) %>%
gsub("Hungary", "Ungaria", .)) %>%
mutate(tax_rate = gsub("ETR_K", "Capital", tax_rate) %>%
gsub("ETR_L", "Muncă", .)) %>%
ggplot(aes(x=year, y=valoare, group=tax_rate)) +
geom_line(aes(colour=tax_rate), size=1) +
facet_wrap(~country_name, ncol=2, scales='free') +
scale_y_continuous(labels=scales::percent_format(scale=100)) +
labs(title = "Rata de taxare efectivă capital-muncă",
caption="Sursa: Banca Mondială, Globalization Factor Taxation Dataset",
x="Anul", y=NULL, colour="Indicator") +
scale_color_manual(values=culori[c(1, 5)]) +
theme(legend.position = "top")
culori %>% barplot(rep(1, 8), col=.)
rbiplot <- function(mat, p=1, clusters=4, k=15, scale=TRUE){
x <- mat[,apply(mat, MARGIN=2, FUN=mean)>p, drop=F] %>% colnames()
pca <- sparsepca::robspca(mat, scale=scale, verbose=FALSE)
procent <- pca$eigenvalues^2/sum(pca$eigenvalues^2)
procent <- paste(round(100*procent[1:2], 1), "%")
rot <- as_tibble(pca$loadings) %>% mutate(var=colnames(mat)) %>% filter(var%in%x)
model <- kmeans(pca$scores[,1:2], centers=clusters)$cluster
coords <- as_tibble(pca$scores, rownames="geo") %>%
mutate(cluster = as.factor(model))
ggplot(coords, aes(x=V1, y=V2)) +
ggConvexHull::geom_convexhull(aes(x=V1, y=V2, group=cluster, fill=cluster), alpha=0.2) +
geom_point(colour='red3') +
ggrepel::geom_text_repel(aes(label=geo),nudge_y=0.3, max.overlaps = 10) +
geom_vline(xintercept = 0,linetype=2) +
geom_hline(yintercept=0, linetype=2) +
geom_segment(data=rot, aes(xend=k*V1, x=0, yend=k*V2, y=0),
arrow = arrow(length = unit(0.25, "cm")), colour=culori[7]) +
ggrepel::geom_text_repel(data=rot, aes(label=var,x=k*V1, y=k*V2),
alpha=0.9, colour=culori[7], size=3) +
labs(title="PCA - Biplot", subtitle="Componentele principale (robuste) ale cheltuielilor COFOG99 pe 2017-2021",
x=paste0("Dim1 (", procent[1], ")"), y=paste0("Dim2 (", procent[2],")")) +
theme(axis.title = element_text(size=14)) +
scale_fill_manual(values = culori)
}
rbiplot <- function(mat, p=1, clusters=4, k=15, scale=TRUE){
x <- mat[,apply(mat, MARGIN=2, FUN=mean)>p, drop=F] %>% colnames()
pca <- sparsepca::robspca(mat, scale=scale, verbose=FALSE)
procent <- pca$eigenvalues^2/sum(pca$eigenvalues^2)
procent <- paste(round(100*procent[1:2], 1), "%")
rot <- as_tibble(pca$loadings) %>% mutate(var=colnames(mat)) %>% filter(var%in%x)
model <- kmeans(pca$scores[,1:2], centers=clusters)$cluster
coords <- as_tibble(pca$scores, rownames="geo") %>%
mutate(cluster = as.factor(model))
ggplot(coords, aes(x=V1, y=V2)) +
ggConvexHull::geom_convexhull(aes(x=V1, y=V2, group=cluster, fill=cluster), alpha=0.2) +
geom_point(colour='red3') +
ggrepel::geom_text_repel(aes(label=geo),nudge_y=0.3, max.overlaps = 10) +
geom_vline(xintercept = 0,linetype=2) +
geom_hline(yintercept=0, linetype=2) +
geom_segment(data=rot, aes(xend=k*V1, x=0, yend=k*V2, y=0),
arrow = arrow(length = unit(0.25, "cm")), colour=culori[7]) +
ggrepel::geom_text_repel(data=rot, aes(label=var,x=k*V1, y=k*V2),
alpha=0.9, colour=culori[7], size=3) +
labs(title="PCA - Biplot", subtitle="Componentele principale (robuste) ale cheltuielilor COFOG99 pe 2017-2021",
caption="Sursa: calcule pe Eurostat, gov_10a_main",
x=paste0("Dim1 (", procent[1], ")"), y=paste0("Dim2 (", procent[2],")")) +
theme(axis.title = element_text(size=14)) +
scale_fill_manual(values = culori)
}
mat_venituri <- read_csv("/home/petre/R/proiecte/taxare/database/PCA_venituri.csv") %>% column_to_rownames("geo")
mat_cheltuieli <- read_csv('/home/petre/R/proiecte/taxare/database/PCA_cheltuieli.csv') %>% column_to_rownames("geo")
rbiplot(mat_venituri, p=0.5, clusters=6, k=15) +
labs(subtitle = "Componentele principale (robuste) ale veniturilor bugetare pe 2017-2021", title="PCA - biplot cu veniturile bugetare")
rbiplot(mat_cheltuieli, p=0.3, clusters=4, k=15) +
labs(title="PCA - biplot cu cheltuielile bugetare")
taxe %>%
filter(grepl("Taxes on income$", na_item)) %>%
filter(time=="2021-01-01") %>%
mutate(geo=fct_reorder(geo, values)) %>%
ggplot(aes(x=geo, y=values)) +
geom_col(fill=culori[1]) + coord_flip() +
scale_y_continuous(labels=scales::percent_format(scale=1)) +
labs(title="Impozit pe venit - total", subtitle="Anul 2021",
y="Procent din PIB", x="Ţară", caption="Sursa: Eurostat, gov_10a_taxag")
taxe
1+1
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000)
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>% filter(praguri<1250000)
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>% filter(praguri<1250000) %>% tail()
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>% filter(praguri<1255000) %>% tail()
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>% filter(praguri<1260000) %>% tail()
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>% filter(praguri<1280000) %>% tail()
profit <- numeric(100)
praguri <- seq(0, 4870000, length.out=100)
for(i in 1:100){
profit[i] <- firme %>% filter(grepl("uu", categorie)) %>%
mutate(profit = if_else(cifra_afaceri>praguri[i],
0.16*profit_brut, 0.01*cifra_afaceri)) %>%
pull(profit) %>% sum(na.rm=TRUE)
}
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>%
ggplot(aes(x=praguri, y=profit)) + geom_line() + geom_point() +
labs(title = "Impozit pe profit colectat din bilanţurile de tip UU",
subtitle="Miliarde RON", x="Prag (RON)", y="Impozit colectat") +
scale_x_continuous(labels = scales::number_format(big.mark=','))
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000)
tibble("praguri"=praguri, "profit"=profit) %>%
mutate(profit=profit/1000000000) %>% filter(praguri<1280000) %>% tail()
library(tidyverse)
library(gt)
library(TEMPO)
culori <- c("#EA5B0C", "#a44a08", "#ea960c", "#ea150c",
"#a40e08", "#000000", "#0865a4", "#a48408")
theme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 16,
strip_text_family = "Frutiger Bold",
strip_text_face = "italic",
axis_title_size = 14,
axis_text_size = 12,
base_family = "Frutiger",
plot_title_family = "Frutiger Bold",
subtitle_family = "Frutiger",
caption_family = "Frutiger",
caption_size = 12) +
theme(legend.text = element_text(size=14),
legend.title = element_text(size=16),
legend.key.size = unit(0.8, "cm")))
firme <- read_csv(here::here("database", "bl_bs_sl+ir+uu.csv")) %>%
select(cui, caen, cifra_afaceri=cifra_de_afaceri_neta,
profit_net, profit_brut, pierdere_neta,
salariati=numar_mediu_de_salariati,
categorie) %>% mutate(caen=as.character(caen))
barplot(culori)
barplot(rep(1,1),col=culori)
barplot(rep(1,8),col=culori)
insumat <- sume_alimentar %>% mutate(sector="Alimentar & Agricultura") %>%
select(sector, caen, valoare=sume) %>%
bind_rows(sume_constructii %>% mutate(sector="Construcţii") %>%
select(sector, caen, valoare=sume),
sume_energie %>% mutate(sector="Energie"),
sume_it %>% mutate(sector="IT") %>% select(sector, caen, valoare=sume),
sume_jocuri %>% mutate(sector="Jocuri de noroc"),
sume_retail %>% mutate(sector="Retail"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL"))
insumat %>% rename(CAEN=caen, VALOARE = valoare) %>%
mutate(sector=str_to_upper(sector)) %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact taxe sectoriale şi eliminări scutiri (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anului 2021") %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "70%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote = "Eliminare scutire actuală",
locations = cells_row_groups(groups=c("ALIMENTAR & AGRICULTURA",
"CONSTRUCŢII", "IT"))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_row_groups(groups="ENERGIE")) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_row_groups("JOCURI DE NOROC")) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_row_groups(groups="RETAIL")) %>% gt::gtsave("tabel_profit.png")
library(tidyverse)
library(gt)
culori <- c("#EA5B0C", "#a44a08", "#ea960c", "#ea150c",
"#a40e08", "#000000", "#0865a4", "#a48408")
theme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 16,
strip_text_family = "Frutiger Bold",
strip_text_face = "italic",
axis_title_size = 14,
axis_text_size = 12,
base_family = "Frutiger",
plot_title_family = "Frutiger Bold",
subtitle_family = "Frutiger",
caption_family = "Frutiger",
caption_size = 12) +
theme(legend.text = element_text(size=14),
legend.title = element_text(size=16),
legend.key.size = unit(0.8, "cm")))
taxari <- read_csv(here::here("database", "taxation_trends_eurostat.csv"))
grafice <- function(df, var, numar=10){
segmente <- df %>% filter(time%in%c("2009", "2021")) %>%
select(geo, what, time, var) %>%
spread(what, var) %>%
pivot_wider(names_from = time, values_from = c(PIB, Total)) %>%
filter(!grepl("Luxemb|Irlanda|Malta|Cipru", geo)) %>%
mutate(centru_x = 0.5*(Total_2009+Total_2021),
centru_y=0.5*(PIB_2009+PIB_2021)) %>%
mutate(delta = sqrt((PIB_2021-PIB_2009)^2 + (Total_2021-Total_2009)^2)) %>%
mutate(directie = if_else(PIB_2021 < PIB_2009 & Total_2021 < Total_2009,
"Scădere", "Creştere")) %>%
arrange(desc(delta))
tari <- segmente %>%
arrange(desc(delta)) %>%
mutate(index = if_else(row_number()<numar | geo=="Romania", 1, 0)) %>%
filter(index==1) %>% select(-index) %>% pull(geo)
segmente %>%
ggplot(aes(x=Total_2009, y=PIB_2009)) +
geom_point(colour='red3') +
geom_point(colour='red3', aes(x=Total_2021, y=PIB_2021)) +
geomtextpath::geom_textsegment(aes(x=Total_2009, xend=Total_2021,
y=PIB_2009, yend=PIB_2021, label=geo, size=delta,
colour=directie),
vjust=-0.3, arrow = arrow(length=unit(0.3, "cm")),
show.legend = c("size"=FALSE)) +
scale_x_continuous(labels=scales::percent_format(scale=1)) +
scale_y_continuous(labels=scales::percent_format(scale=1)) +
scale_size_continuous(range=c(2, 4)) +
scale_colour_manual(values=c(culori[7], culori[4])) +
gghighlight::gghighlight(geo%in%tari) +
theme(legend.position = 'top')
}
rbiplot <- function(mat, p=1, clusters=4, k=15, scale=TRUE){
x <- mat[,apply(mat, MARGIN=2, FUN=mean)>p, drop=F] %>% colnames()
pca <- sparsepca::robspca(mat, scale=scale, verbose=FALSE)
procent <- pca$eigenvalues^2/sum(pca$eigenvalues^2)
procent <- paste(round(100*procent[1:2], 1), "%")
rot <- as_tibble(pca$loadings) %>% mutate(var=colnames(mat)) %>% filter(var%in%x)
model <- kmeans(pca$scores[,1:2], centers=clusters)$cluster
coords <- as_tibble(pca$scores, rownames="geo") %>%
mutate(cluster = as.factor(model))
ggplot(coords, aes(x=V1, y=V2)) +
ggConvexHull::geom_convexhull(aes(x=V1, y=V2, group=cluster, fill=cluster), alpha=0.2) +
geom_point(colour='red3') +
ggrepel::geom_text_repel(aes(label=geo),nudge_y=0.3, max.overlaps = 10) +
geom_vline(xintercept = 0,linetype=2) +
geom_hline(yintercept=0, linetype=2) +
geom_segment(data=rot, aes(xend=k*V1, x=0, yend=k*V2, y=0),
arrow = arrow(length = unit(0.25, "cm")), colour=culori[7]) +
ggrepel::geom_text_repel(data=rot, aes(label=var,x=k*V1, y=k*V2),
alpha=0.9, colour=culori[7], size=3) +
labs(title="PCA - Biplot",
subtitle="Componentele principale (robuste) ale categoriilor de impozite",
caption="Sursa: calcule pe datele Taxation trends in the European Union",
x=paste0("Dim1 (", procent[1], ")"), y=paste0("Dim2 (", procent[2],")")) +
theme(axis.title = element_text(size=14)) +
scale_fill_manual(values = culori)
}
grafice(taxari, var = "capital", numar=10) +
labs(title=paste("Taxarea pe capital", "2009 vs 2021"),
subtitle="Sursa: Taxation trends in the European Union",
x="din Total", y="din PIB")
taxari %>% filter(geo=="Romania",what=="PIB") %>%
select(-what, -geo) %>% gt::gt(rowname_col = "time") %>%
gt::fmt_number(2:6, decimals = 2) %>%
gt::tab_header(title="România - % din PIB pentru diferite taxe") %>%
gt::tab_header(title="Media anilor 2012-2022 a balanţei bugetare") %>%
gt::tab_style(style = gt::cell_fill(color=culori[5]),
locations = gt::cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000")
taxari %>% filter(geo=="Romania",what=="PIB") %>%
select(-what, -geo) %>% gt::gt(rowname_col = "time") %>%
gt::fmt_number(2:6, decimals = 2) %>%
gt::tab_header(title="România - % din PIB pentru diferite taxe") %>%
gt::tab_style(style = gt::cell_fill(color=culori[5]),
locations = gt::cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1], alpha=0.5),
locations=cells_row_groups())
taxari %>% filter(geo=="Romania",what=="PIB") %>%
select(-what, -geo) %>% gt::gt(rowname_col = "time") %>%
gt::fmt_number(2:6, decimals = 2) %>%
gt::tab_header(title="România - % din PIB pentru diferite taxe") %>%
gt::tab_style(style = gt::cell_fill(color=culori[5]),
locations = gt::cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1], alpha=0.5),
locations=cells_row_groups()) %>% gtsave("tabel_tipuri_taxe.png")
taxari %>% filter(geo=="Romania",what=="PIB") %>%
select(-what, -geo) %>% gt::gt(rowname_col = "time") %>%
gt::fmt_number(2:6, decimals = 2) %>%
gt::tab_header(title="România - % din PIB pentru diferite taxe",
subtitle = "Sursa: Taxation Trends in European Union") %>%
gt::tab_style(style = gt::cell_fill(color=culori[5]),
locations = gt::cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1], alpha=0.5),
locations=cells_row_groups())
taxari %>% filter(geo=="Romania",what=="PIB") %>%
select(-what, -geo) %>% gt::gt(rowname_col = "time") %>%
gt::fmt_number(2:6, decimals = 2) %>%
gt::tab_header(title="România - % din PIB pentru diferite taxe",
subtitle = "Sursa: Taxation Trends in European Union") %>%
gt::tab_style(style = gt::cell_fill(color=culori[5]),
locations = gt::cells_title()) %>%
gt::tab_style(style=gt::cell_text(color="white"), locations=gt::cells_title()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[1]),
locations = gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_text(color="white"),
locations=gt::cells_column_labels()) %>%
gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3),
locations=gt::cells_body()) %>%
gt::tab_options(table.border.left.color = "#000000") %>%
gt::tab_style(style=gt::cell_fill(color=culori[1], alpha=0.5),
locations=cells_row_groups()) %>% gtsave("tabel_tipuri_taxe.png")
barplot(rep(1,8), col=culori)
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_text(color="#fff"), locations=cells_grand_summary())
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="10 % taxă pe tranzacţiile imobiliare",
locations=cells_body(columns=Masura,
rows=grepl("IMOBILIARE", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura,
rows=grepl("JOCURI", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura,
rows=grepl("RETAIL", Masura))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura,
rows=grepl("venit", Masura))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura,
rows=grepl("dividende", Masura))) %>%
gt::tab_footnote(footnote="Scăderea pragului de venit al microîntreprinderii la 500.000 EURO",
locations=cells_body(columns=Masura, rows=grepl("prag", Masura)))
barplot(rep(1,8), col=culori)
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_fill(color=culori[3], alpha=0.5),
locations=cells_summary()) %>%
tab_style(style=cell_text(color="#fff"),
locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="10 % taxă pe tranzacţiile imobiliare",
locations=cells_body(columns=Masura,
rows=grepl("IMOBILIARE", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura,
rows=grepl("JOCURI", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura,
rows=grepl("RETAIL", Masura))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura,
rows=grepl("venit", Masura))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura,
rows=grepl("dividende", Masura))) %>%
gt::tab_footnote(footnote="Scăderea pragului de venit al microîntreprinderii la 500.000 EURO",
locations=cells_body(columns=Masura, rows=grepl("prag", Masura)))
insumari %>%
gt::gt(groupname_col = "sector") %>%
gt::fmt_number(columns=3, decimals = 2) %>%
tab_header(title="Impact tipuri de măsuri propuse (miliarde RON)",
subtitle="Calcule proprii pe bilanţurile anilor 2019-2021") %>%
summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)),
fmt = ~fmt_number(.,decimals=2)) %>%
grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)),
fmt=~fmt_number(., decimals=2)) %>%
gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)),
fmt = ~fmt_number(., decimals = 2)) %>%
tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%
tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%
tab_style(style=cell_text(weight = "bold"), locations=cells_row_groups()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%
tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%
tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%
tab_style(style=cell_fill(color=culori[3], alpha=0.5),
locations=cells_summary()) %>%
tab_style(style=cell_text(color="#fff"),
locations=cells_grand_summary()) %>%
gt::tab_options(container.width = "90%", table.layout = "auto",
table.align = "center",
table.additional_css = "table.gt_table {border: 2px solid black;}") %>%
gt::tab_footnote(footnote="10 % taxă pe tranzacţiile imobiliare",
locations=cells_body(columns=Masura,
rows=grepl("IMOBILIARE", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON", locations = cells_body(columns=Masura, rows=grepl("ENERGIE", Masura))) %>%
gt::tab_footnote(footnote = "1.2 % impozit pe cifra de afaceri pentru toate firmele",
locations=cells_body(columns=Masura,
rows=grepl("JOCURI", Masura))) %>%
gt::tab_footnote(footnote="1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON", locations=cells_body(columns=Masura,
rows=grepl("RETAIL", Masura))) %>%
gt::tab_footnote(footnote = "Asumând cote de 16 % şi 21 % pentru ce trece de 2200 EURO lunar brut (scenariul slovac)",
locations=cells_body(columns=Masura,
rows=grepl("venit", Masura))) %>%
gt::tab_footnote(footnote="Impozit pe dividende de 18 %",
locations=cells_body(columns=Masura,
rows=grepl("dividende", Masura))) %>%
gt::tab_footnote(footnote="Scăderea pragului de venit al microîntreprinderii la 500.000 EURO",
locations=cells_body(columns=Masura, rows=grepl("prag", Masura))) %>% gtsave("tabel_total.png")
