[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Reforma fiscală: propuneri pe termen scurt",
    "section": "",
    "text": "În acest document vom efectua analiza încasărilor la buget din diferite surse, vom face simulări şi vom prezenta situaţia existentă în Europa şi în România."
  },
  {
    "objectID": "Generalitati.html",
    "href": "Generalitati.html",
    "title": "1  Generalităţi",
    "section": "",
    "text": "Vom folosi în general în acest document filele Eurostat gov_10a_taxag pentru taxe şi venituri şi gov_10a_exp pentru cheltuieli şi gov_10a_main pentru agregatele principale ale finanţelor publice.\n\n\nArată codul\nlibrary(tidyverse)\nlibrary(gt)\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#000000\", \"#0865a4\", \"#a48408\")\n\n\n\n\nArată codul\ntaxe <- read_csv(\"database/gov_10a_taxag_prelucrat.csv\")\ncheltuieli <- read_csv(\"database/gov_10a_exp_prelucrat.csv\")\nagregate <- read_csv(\"database/gov_10a_main_prelucrat.csv\")\ntaxe_total <- read_csv(here::here(\"database\", \"gov_10a_taxag_procent_din_buget.csv\"))\n\n\n\n\nArată codul\nagregate %>% filter(grepl(\"Total general\", na_item)) %>% \n  filter(time>\"1995-01-01\") %>%\n  filter(grepl(\"Romania|Bulgaria|Ungaria|Cehia|Polonia|Croatia|Media UE\", geo)) %>% mutate(na_item = gsub(\"^.+expenditure$\", \"Cheltuieli totale\", na_item) %>% \n                 gsub(\"^.+revenue\", \"Venituri totale\", .)) %>%\n  ggplot(aes(x=time, y=values, group=geo)) + \n  geom_line(aes(colour=geo, linewidth=geo==\"Romania\"), \n            show.legend = c(\"linewidth\"=FALSE)) + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_x_date(date_breaks = \"3 years\", date_minor_breaks = \"1 year\",\n               date_labels = \"%Y\") +\n  facet_wrap(~na_item, ncol=1, scales='free') +\n  labs(title=NULL, y=\"Procent din PIB\", x=NULL, \n       linewidth=NULL, colour=\"Ţară\", caption=\"Sursa: Eurostat, gov_10a_main\") +\n  scale_linewidth_manual(values=c(0.5, 1.2)) +\n  scale_color_manual(values=culori)\n\n\n\n\n\nSe observă clar din grafic că unde nu excelează deloc România este categoria veniturilor. Cheltuielile sunt şi ele la coada clasamentului, chiar pentru Europa de Est. Să vedem veniturile totale fiscale.\n\n\nArată codul\ntaxe %>% \n  filter(grepl(\"Total receipts from taxes and social.+contributions after deduction\",\n               na_item)) %>% \n    filter(grepl(\"Romania|Bulgaria|Ungaria|Cehia|Polonia|Croatia|Media UE\", geo)) %>%\n    ggplot(aes(x=time, y=values, group=geo)) + \n    geom_line(aes(colour=geo, linewidth=geo==\"Romania\"), \n              show.legend = c(\"linewidth\"=FALSE)) + \n    scale_y_continuous(labels=scales::percent_format(scale=1)) +\n    scale_x_date(date_breaks = \"3 years\", date_minor_breaks = \"1 year\",\n                 date_labels = \"%Y\") +\n    labs(title=\"Venituri fiscale\", y=\"Procent din PIB\", x=\"An\", \n         linewidth=NULL, colour=\"Ţară\", caption=\"Sursa: Eurostat, gov_10a_taxag\") +\n    scale_linewidth_manual(values=c(0.5, 1.2)) +\n    scale_color_manual(values=culori)\n\n\n\n\n\nSă vedem un grafic cu structura veniturilor la buget în câteva ţări apropiate.\n\n\nArată codul\ntaxe_total %>% \n  filter(grepl(\"Ungaria|Romania|Italia|Suedia|UE|Bulgaria|Cehia|Slovacia\", geo)) %>%\n  filter(time==\"2021-01-01\") %>% filter(grepl(\"Current taxes on income|Net social contributions|Taxes on production and import\",na_item)) %>% \n  mutate(na_item = gsub(\"Current.+$\", \"Impozite pe venit, avere, etc.\", na_item) %>% \n                   gsub(\"Net social.+\", \"Contribuţii sociale nete\", .) %>%\n                   gsub(\"Taxes on production.+\", \"Taxe pe producţie şi importuri\", .)) %>%\n  ggplot(aes(x=geo, y=values, fill=na_item)) + \n  geom_col(aes(fill=na_item)) + \n  geom_text(aes(x=geo, y=values, group=na_item, label=paste(round(values, 2), \"%\")), \n            colour='white', position = position_stack(vjust=0.5), size=3) +\n  scale_fill_manual(values=culori[c(1, 5, 8)]) + \n  labs(title=\"Structura veniturilor la buget\", \n       caption=\"Sursa: Eurostat, gov_10a_taxag\", \n       x=NULL, y=NULL, fill=\"Categorie\") + \n  scale_y_continuous(labels=scales::percent_format(scale=1))\n\n\n\n\n\nSă vizualizăm pe axa cheltuieli totale vs venituri totale cum stăm, însumând anii 2012-2022. Mărimea etichetei din grafic reprezintă mărimea excedentului sau, după caz, a deficitului bugetar. România iese la iveală uşor.\n\n\nArată codul\ndb <- agregate %>% \n  filter(grepl(\"Total general\", na_item)) %>% \n  mutate(na_item = gsub(\"^.+expenditure$\", \"Cheltuieli totale\", na_item) %>%\n           gsub(\"^.+revenue\", \"Venituri totale\", .)) %>% \n  mutate(time=lubridate::year(time)) %>% filter(time>2011) %>% \n  group_by(geo, na_item) %>% \n  summarise(values=mean(values)) %>% ungroup() %>% \n  pivot_wider(names_from=c(na_item), values_from=values) %>% \n  mutate(deficit = 100*(`Venituri totale`-`Cheltuieli totale`)) %>% \n  mutate(index = if_else(deficit>0, \"Excedent\", \"Deficit\")) \n\n  ggplot(db, aes(x=`Venituri totale`, y=`Cheltuieli totale`)) +\n  geom_point(aes(colour=index)) +\n  ggrepel::geom_text_repel(data=db %>%filter(geo!=\"Romania\"),\n                           aes(label=geo, size=abs(deficit), \n                               colour=index),\n                           show.legend = c(\"size\"=FALSE)) +\n  ggtext::geom_richtext(data=db%>% filter(geo=='Romania'), \n                        aes(x=`Venituri totale`, y=`Cheltuieli totale`, \n                            label=\"<b>Romania</b>\"), \n                        fill=NA, label.color=NA, nudge_y = 1) +\n  geom_abline(slope=1, intercept=0, linetype=2) + \n  scale_colour_manual(values=culori[c(1, 5)]) + \n  scale_x_continuous(labels=scales::percent_format(scale=1)) +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_size_continuous(range=c(2, 4)) + \n  labs(title=\"Deficitul bugetar\", subtitle=\"Media 2012-2022\", \n       size=NULL, colour=\"Sold bugetar\", caption=\"Sursa: Eurostat, gov_10a_main\") \n\n\n\n\n\nŞi un tabel în ordinea descrescătoare a deficitului bugetar.\n\n\nArată codul\nagregate %>% filter(grepl(\"Total general\", na_item)) %>% \n  mutate(na_item = gsub(\"^.+expenditure$\", \"Cheltuieli totale\", na_item) %>%\n           gsub(\"^.+revenue\", \"Venituri totale\", .)) %>% \n  mutate(time=lubridate::year(time)) %>% filter(time>2011) %>% \n  group_by(geo, na_item) %>% summarise(values=mean(values)) %>% \n  ungroup() %>% pivot_wider(names_from=c(na_item), values_from=values) %>%\n  mutate(Balanta = (`Venituri totale`-`Cheltuieli totale`)) %>% \n  arrange((Balanta)) %>% filter(row_number()<11) %>% \n  rename(\"Ţări\"=geo) %>% gt::gt() %>% \n  gt::fmt_number(columns=2:4, decimals = 2) %>% \n  gt::fmt_percent(columns=2:4, force_sign = T, scale_values = FALSE, \n                  accounting = FALSE) %>% \n  gt::tab_header(title=\"Media anilor 2012-2022 a balanţei bugetare\",\n                 subtitle=\"Sursa: calcule pe Eurostat, gov_10a_main\") %>%\n  gt::tab_style(style=gt::cell_fill(color=culori[1]), \n                locations = gt::cells_column_labels()) %>% \n  gt::tab_style(style=gt::cell_text(color=\"white\"), \n                locations=gt::cells_column_labels()) %>% \n  gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3), \n                locations=gt::cells_body()) %>% \n  gt::tab_options(table.border.left.color = \"#000000\") %>%\n  gtExtras::gt_theme_538() %>% \n  gt::opt_table_font(font=\"Frutiger\") %>%\n  gtExtras::gt_highlight_rows(rows=6)\n\n\n\n\n\n\n  \n    \n      Media anilor 2012-2022 a balanţei bugetare\n    \n    \n      Sursa: calcule pe Eurostat, gov_10a_main\n    \n    \n      Ţări\n      Cheltuieli totale\n      Venituri totale\n      Balanta\n    \n  \n  \n    Spania\n+45.76%\n+39.82%\n−5.95%\n    Franta\n+57.36%\n+52.94%\n−4.43%\n    Grecia\n+53.60%\n+49.19%\n−4.41%\n    Italia\n+51.69%\n+47.45%\n−4.24%\n    Slovenia\n+48.44%\n+44.54%\n−3.90%\n    Romania\n+36.70%\n+32.83%\n−3.87%\n    Ungaria\n+48.41%\n+44.88%\n−3.53%\n    Belgia\n+54.45%\n+51.08%\n−3.37%\n    Portugalia\n+46.94%\n+43.56%\n−3.37%\n    Polonia\n+43.02%\n+40.14%\n−2.88%\n  \n  \n  \n\n\n\n\nConcluzia acestei secţiuni este că nu cheltuielile sunt mari, într-adevăr cu greu ar putea fi tăiate şi mai mult, ci veniturile sunt foarte mici. Doar Irlanda, Elveţia şi Lituania au venituri din PIB mai mici ca noi făcând media ultimilor 10 ani. Pentru anul 2022 România a avut cel mai mic procent din PIB ca venituri, în afară de Irlanda."
  },
  {
    "objectID": "Generalitati.html#povara-taxării-e-totuşi-mare",
    "href": "Generalitati.html#povara-taxării-e-totuşi-mare",
    "title": "1  Generalităţi",
    "section": "1.2 Povara taxării e totuşi mare",
    "text": "1.2 Povara taxării e totuşi mare\nDeşi stăm foarte prost ca venituri fiscale şi totale ca procent din PIB, cheltuielile fiind şi ele la coada clasamentului european, povara efectivă asupra salariatului obişnuit este deosebit de mare. OECD are un instrument de calcul al poverii fiscale, OECD tax calculator, pentru ţările membre şi câteva nemembre, printre care şi România. Povara fiscală (partea sub 0 a graficului), este cea mai mare în România din toată Europa.\n\n\nArată codul\noecd <- read_csv(here::here(\"database\", \"oecd_calculator.csv\")) %>%\n        inner_join(read_csv(here::here(\"database\", \"dictionar_tari.csv\")) %>% \n                   rename(Country=geo)) %>% select(-Country) %>% \n        rename(geo=tari) %>% relocate(geo) %>% select(-year)\n\noecd %>% \n  mutate(across(net:sc, ~100*./`Average Wage`)) %>% \n  mutate(across(it:sc, ~-.)) %>% mutate(geo = fct_reorder(geo, net)) %>% \n  gather(gross:sc, key='Indicator', value='valoare') %>% \n  mutate(Indicator = gsub(\"^it$\", \"Impozit pe venit\", Indicator) %>%\n                     gsub(\"^gross$\", \"Venit brut din muncă\", .) %>%\n                     gsub(\"^iw$\", \"Beneficii în muncă\", .) %>%\n                     gsub(\"^sc$\", \"Contribuţii sociale\", .)) %>%\n  ggplot(aes(x=geo, y=valoare, fill=Indicator)) + \n  geom_col(aes(fill=Indicator)) + \n  geom_point(aes(x=geo, y=net), shape=8, show.legend = F) + \n  scale_fill_manual(values=culori[c(7, 3, 5, 1)]) + \n  theme(axis.text.x=element_text(angle=90, size=12), legend.position = \"top\") +\n  labs(title = \"Povara fiscală şi venitul net per gospodărie\", \n       subtitle=\"* - Venitul net per gospodărie pentru un cuplu fără copii\", \n       x=NULL, y=\"%\", \n       caption='Sursa: OECD Tax Calculator, 2022') +\n  scale_y_continuous(labels=scales::percent_format(scale=1), \n                     breaks = c(200, 150, 100, 50, 0, -50, -100))"
  },
  {
    "objectID": "Generalitati.html#taxarea-capital---muncă-conform-băncii-mondiale",
    "href": "Generalitati.html#taxarea-capital---muncă-conform-băncii-mondiale",
    "title": "1  Generalităţi",
    "section": "1.3 Taxarea capital - muncă conform Băncii Mondiale",
    "text": "1.3 Taxarea capital - muncă conform Băncii Mondiale\nExistă un nou set de date de la Banca Mondială care permite compararea ratelor de taxare efectivă pe capital şi muncă de-a lungul ţărilor şi anilor. Să vedem evoluţia în cele patru ţări din zona noastră.\n\n\nArată codul\nread_csv(\"https://raw.githubusercontent.com/pierrebachas/Globalization_Factor_Taxation/main/globalETR_bfjz.csv\") %>% \n  select(country_name, year, region, ETR_L, ETR_K) %>% \n  filter(country_name%in%c(\"Romania\", \"Hungary\", \"Bulgaria\", \"Poland\")) %>% \n  gather(ETR_L:ETR_K, key=\"tax_rate\", value='valoare') %>% \n  mutate(country_name=gsub(\"Poland\", \"Polonia\", country_name) %>% \n                      gsub(\"Hungary\", \"Ungaria\", .)) %>%\n  mutate(tax_rate = gsub(\"ETR_K\", \"Capital\", tax_rate) %>% \n                    gsub(\"ETR_L\", \"Muncă\", .)) %>% \n  ggplot(aes(x=year, y=valoare, group=tax_rate)) + \n  geom_line(aes(colour=tax_rate), size=1) + \n  facet_wrap(~country_name, ncol=2, scales='free') +\n  scale_y_continuous(labels=scales::percent_format(scale=100)) +\n  labs(title = \"Rata de taxare efectivă capital-muncă\", \n      caption=\"Sursa: Banca Mondială, Globalization Factor Taxation Dataset\",\n       x=\"Anul\", y=NULL, colour=\"Indicator\") +\n  scale_color_manual(values=culori[c(1, 5)]) +\n  theme(legend.position = \"top\")"
  },
  {
    "objectID": "Generalitati.html#categorii-de-impozite-pe-venit",
    "href": "Generalitati.html#categorii-de-impozite-pe-venit",
    "title": "1  Generalităţi",
    "section": "1.4 Categorii de impozite pe venit",
    "text": "1.4 Categorii de impozite pe venit\nVom vizualiza profile de ţări după veniturile şi cheltuielile lor ca procent din PIB. Acest lucru ne ajută pentru a ne face o idee despre diversele moduri în care cheltuie sau colectează ţările europene banii la buget. Vom aplica metodologia PCA (“Principal Component Analysis” sau “Analiza componentelor principale”) pentru a reduce dimensionalitatea de la un set cu număr mare de variabile originale (categorii de venituri sau cheltuieli, după caz) la doar două axe principale care reprezintă o hartă a similarităţii ţărilor considerând variabilele originale. Important, vom folosi versiunea robustă, insensibilă la outlieri, nu cea originală. Axele sunt ecuaţii liniare, simple funcţii liniare compuse din variabile originale, coeficienţii fiind calculaţi în aşa fel încât axele noastre să surprindă cel mai mult cu putinţă din variaţia variabilelor originale.\n\n\nArată codul\nrbiplot <- function(mat, p=1, clusters=4, k=15, scale=TRUE){\n  x <- mat[,apply(mat, MARGIN=2, FUN=mean)>p, drop=F] %>% colnames()\n  pca <- sparsepca::robspca(mat, scale=scale, verbose=FALSE)\n  procent <- pca$eigenvalues^2/sum(pca$eigenvalues^2)\n  procent <- paste(round(100*procent[1:2], 1), \"%\")\n  rot <- as_tibble(pca$loadings) %>% mutate(var=colnames(mat)) %>% filter(var%in%x)\n  model <- kmeans(pca$scores[,1:2], centers=clusters)$cluster\n  coords <- as_tibble(pca$scores, rownames=\"geo\") %>%\n    mutate(cluster = as.factor(model))\n  ggplot(coords, aes(x=V1, y=V2)) + \n    ggConvexHull::geom_convexhull(aes(x=V1, y=V2, group=cluster, fill=cluster), alpha=0.2) +\n    geom_point(colour='red3') + \n    ggrepel::geom_text_repel(aes(label=geo),nudge_y=0.3, max.overlaps = 10, size=3) +\n    geom_vline(xintercept = 0,linetype=2) +\n    geom_hline(yintercept=0, linetype=2) +\n    geom_segment(data=rot, aes(xend=k*V1, x=0, yend=k*V2, y=0), \n                 arrow = arrow(length = unit(0.25, \"cm\")), colour=culori[7]) +\n    ggrepel::geom_text_repel(data=rot, aes(label=var,x=k*V1, y=k*V2), \n                             alpha=0.9, colour=culori[7], size=2) +\n    labs(title=\"PCA - Biplot\", \n         subtitle=\"Componentele principale (robuste) ale cheltuielilor COFOG99 pe 2017-2021\", \n         caption=\"Sursa: calcule pe Eurostat, gov_10a_main\",\n         x=paste0(\"Dim1 (\", procent[1], \")\"), y=paste0(\"Dim2 (\", procent[2],\")\")) +\n    theme(axis.title = element_text(size=14)) +\n    scale_fill_manual(values = culori)\n  \n}\n\n\nSă începem cu veniturile. Avem 34 de variabile originale pe care le vom reduce la cele două axe principale. Împreună cele două axe explică 58.8 % din variabilitatea datelor originale (vezi valorile din paranteză). Cu albastru avem contribuţia variabilelor originale la axele noastre afişate. Practic putem explica de ce România este în poziţia în care este observând săgeţile albastre ce bat înspre ea: contribuţiile sociale ale angajaţilor. Asta însemnă că ţările din direcţia asta (est-europene şi baltice în general) au un procent din PIB mai mare colectat în această categorie de venituri. Culorile reprezintă clusterii descoperiţi de metodologia k-means.\n\n\nArată codul\nmat_venituri <- read_csv(\"/home/petre/R/proiecte/taxare/database/PCA_venituri.csv\") %>% column_to_rownames(\"geo\") \nmat_cheltuieli <- read_csv('/home/petre/R/proiecte/taxare/database/PCA_cheltuieli.csv') %>% column_to_rownames(\"geo\")\n\n\n\n\nArată codul\nrbiplot(mat_venituri, p=0.5, clusters=6, k=15) +\n  labs(subtitle = \"Componentele principale (robuste) ale veniturilor bugetare pe 2017-2021\", title=\"PCA - biplot cu veniturile bugetare\")\n\n\n\n\n\nSă vedem şi la cheltuieli. Aici putem folosi 71 de variabile originale din setul original furnizat de Eurostat. Fiind un set mai mare, este de aşteptat că avem mai puţină variabilitate explicată de aceste două axe (circa 52. 7 %). Dar profilele sunt foarte clare: România cheltuie asemenea ţărilor est-europene şi baltice, doar că pe poliţie, ordine publică (unde suntem locul 4 în Europa ca procent din PIB), cheltuieli cu organe legislative şi executive, apărare, etc. La polul opus sunt statele progresiste cu cheltuieli pe protecţie socială, sănătate, educaţie, etc.\n\n\nArată codul\nrbiplot(mat_cheltuieli, p=0.3, clusters=4, k=15) +\n  labs(title=\"PCA - biplot cu cheltuielile bugetare\")\n\n\n\n\n\nGhidându-ne după aceste grafice putem face analize punctuale mai interesante. De exemplu, care este topul ţărilor care colectează venituri din contribuţii sociale ?\n\n\nArată codul\nmat_venituri %>% as_tibble(rownames='geo') %>% \n  select(geo, matches(\"Compulsory\")) %>% \n  mutate(geo = fct_reorder(geo, `Compulsory employees' actual social contributions`)) %>% \n  ggplot(aes(x=geo, y=`Compulsory employees' actual social contributions`)) +\n  geom_col(fill=culori[1]) + coord_flip() + \n  labs(title=\"Contribuţii sociale obligatorii\", \n       subtitle=\"Pentru angajaţi, media 2017-2021\", \n       y=\"Procent din PIB\", x=\"Ţară\", caption=\"Sursa: Eurostat, gov_10a_main\") + \n  scale_y_continuous(labels=scales::percent_format(scale=1))\n\n\n\n\n\nRomânia este prima, lucru care şi explică poziţionarea ei în direcţia acestei variabile pe biplotul cu venituri. La contribuţiile sociale ale gospodăriilor suntem pe locul 3, lucru de aşteptat întrucât aşa cum arată şi biplotul, ele sunt variabile corelate între ele (săgeţi apropiate ca poziţie şi magnitudine înseamnă variabile bine corelate).\nSă rămânem însă la impozitele pe venit. Graficul următor este relevator.\n\n\nArată codul\ntaxe %>% \n  filter(grepl(\"Taxes on income$\", na_item)) %>% \n  filter(time==\"2021-01-01\") %>% \n  mutate(geo=fct_reorder(geo, values)) %>% \n  ggplot(aes(x=geo, y=values)) + \n  geom_col(fill=culori[1]) + coord_flip() + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  labs(title=\"Impozit pe venit - total\", subtitle=\"Anul 2021\", \n       y=\"Procent din PIB\", x=\"Ţară\", fill=\"Ţară\", \n       caption=\"Sursa: Eurostat, gov_10a_taxag\")\n\n\n\n\n\nE interesant de văzut şi evoluţia acestei categorii.\n\n\nArată codul\ntaxe %>% \n    filter(grepl(\"Taxes on income$\", na_item)) %>% \n    filter(grepl(\"Romania|Bulgaria|Ungaria|Polonia|Croatia|Media UE\", geo)) %>%  \n  ggplot(aes(x=time, y=values, group=geo)) + \n  geom_line(aes(colour=geo, size=geo==\"Romania\"), \n            show.legend = c(\"size\"=FALSE)) + \n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  labs(title=\"Impozite pe venit - total\", x=\"An\", y=\"Procent din PIB\",\n       caption=\"Sursa: Eurostat, gov_10a_taxag\", colour='Ţară') +\n  scale_size_manual(values=c(0.5, 1.5)) +\n  scale_color_manual(values=culori) +\n  scale_x_date(date_breaks = \"3 years\", date_labels = \"%Y\", \n               date_minor_breaks = \"1 year\")\n\n\n\n\n\n\n1.4.1 Impozitul pe profit\nEra de aşteptat, România taxează profiturile mai puţin decât media europeană, dar nu cu mult.\n\n\nArată codul\ntaxe %>% filter(time==\"2021-01-01\") %>% \n  filter(grepl(\"profits.+gains\", na_item)) %>% \n  arrange((values)) %>% mutate(geo=fct_reorder(geo, values)) %>% \n  ggplot(aes(x=geo, y=values)) + geom_col(fill=culori[1]) + \n  coord_flip() + labs(title=\"Impozitul pe profit\", \n                      subtitle=\"Anul 2021\", y=\"Procent din PIB\", x=\"Ţară\", \n                      caption=\"Sursa: Eurostat, gov_10a_taxag\") +\n  scale_y_continuous(labels=scales::percent_format(scale=1))\n\n\n\n\n\nGraficul următor e doar pentru noi, nu l-aş include în raport.\n\n\nArată codul\ntaxe %>% filter(time==\"2021-01-01\") %>% \n  filter(!grepl(\"Total\", na_item)) %>% \n  filter(grepl(\"Media UE|Romania\", geo)) %>% \n  select(-time) %>% spread(geo, values) %>% \n  mutate_at(2:3, ~replace_na(., 0)) %>% \n  mutate(delta = `Media UE`-Romania) %>% \n  arrange(desc(abs(delta))) %>% slice(1:30) %>%\n  mutate(na_item = fct_reorder(na_item, delta)) %>% \n  ggplot(aes(x=na_item, y=delta)) + \n  geom_col(fill=culori[1]) + coord_flip() +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  labs(title=\"Diferenţa dintre media UE şi România\", subtitle=\"Anul 2021\",\n       x=\"Ţară\", y=\"Procent din PIB\", caption=\"Sursa: Eurostat, gov_10a_main\") +\n  theme(plot.title.position = \"plot\")\n\n\n\n\n\nSe pare că doar din impozitul pe venit putem creşte vreo 8 puncte procentuale. Să vedem aceleaşi date sub formă de tabel.\n\n\nArată codul\ntaxe %>% filter(time==\"2021-01-01\") %>% \n  filter(!grepl(\"Total\", na_item)) %>% \n  filter(grepl(\"Romania|Media UE\", geo)) %>% \n  spread(geo, values)  %>% \n  mutate(Diferenta = `Media UE`-Romania) %>% \n  arrange(desc((Diferenta))) %>% select(-time) %>% \n  drop_na() %>% rename(taxa=na_item) %>% \n  filter(Diferenta!=0) %>% gt::gt() %>% \n  gt::fmt_percent(2:4, decimals = 1, scale_values = F) %>% \n  gt::tab_header(title=\"Diferenţa dintre media europeană şi România la veniturile din taxe\") %>% gtExtras::gt_theme_538() %>% \n  gt::opt_table_font(font='Frutiger') %>%\n  gt::tab_style(style=cell_text(font=\"Frutiger Bold\"), cells_title(groups='title')) %>%\n  gt::tab_style(style=cell_fill(color=culori[1]), locations=cells_column_labels()) \n\n\n\n\n\n\n  \n    \n      Diferenţa dintre media europeană şi România la veniturile din taxe\n    \n    \n    \n      taxa\n      Media UE\n      Romania\n      Diferenta\n    \n  \n  \n    Current taxes on income, wealth, etc.\n13.3%\n5.2%\n8.1%\n    Taxes on income\n12.8%\n4.8%\n8.0%\n    Taxes on individual or household income including holding gains\n9.8%\n2.4%\n7.4%\n    Employers' actual social contributions\n7.3%\n1.0%\n6.3%\n    Net social contributions\n14.3%\n11.3%\n3.0%\n    Taxes on production and imports\n13.6%\n10.7%\n2.9%\n    Other taxes on production\n2.4%\n0.8%\n1.6%\n    Taxes on products\n11.2%\n9.9%\n1.3%\n    Value added type taxes (VAT)\n7.4%\n6.5%\n0.9%\n    Taxes on land, buildings and other structures\n1.0%\n0.3%\n0.7%\n    Taxes on the income or profits of corporations including holding gains\n2.9%\n2.2%\n0.7%\n    Taxes on financial and capital transactions\n0.4%\n0.0%\n0.4%\n    Capital taxes\n0.3%\n0.0%\n0.3%\n    Other taxes on production n.e.c.\n0.3%\n0.0%\n0.3%\n    Stamp taxes\n0.3%\n0.0%\n0.3%\n    Taxes on capital transfers\n0.3%\n0.0%\n0.3%\n    Taxes on insurance premiums\n0.3%\n0.0%\n0.3%\n    Excise duties\n0.4%\n0.2%\n0.2%\n    Other current taxes\n0.5%\n0.3%\n0.2%\n    Other current taxes n.e.c.\n0.2%\n0.0%\n0.2%\n    Other taxes on specific services\n0.2%\n0.0%\n0.2%\n    Taxes and duties on imports excluding VAT\n0.4%\n0.2%\n0.2%\n    Taxes on imports excluding VAT and import duties\n0.4%\n0.2%\n0.2%\n    Taxes on products, except VAT and import taxes\n3.4%\n3.3%\n0.1%\n    Other taxes on income n.e.c.\n0.1%\n0.0%\n0.1%\n    Payments by households for licences\n0.2%\n0.1%\n0.1%\n    Taxes on lotteries, gambling and betting\n0.1%\n0.0%\n0.1%\n    Employers' imputed social contributions\n0.9%\n0.8%\n0.1%\n    Taxes on pollution\n0.2%\n0.3%\n−0.1%\n    Taxes on winnings from lottery or gambling\n0.0%\n0.2%\n−0.2%\n    General sales or turnover taxes\n0.0%\n0.3%\n−0.3%\n    Excise duties and consumption taxes\n1.9%\n2.8%\n−0.9%\n    Households' actual social contributions\n6.0%\n9.6%\n−3.6%\n    Compulsory households' actual social contributions\n5.9%\n9.6%\n−3.7%\n    Compulsory employees' actual social contributions\n4.2%\n9.5%\n−5.3%"
  },
  {
    "objectID": "Generalitati.html#concluzie",
    "href": "Generalitati.html#concluzie",
    "title": "1  Generalităţi",
    "section": "1.5 Concluzie",
    "text": "1.5 Concluzie\nMai avem mult de colectat până să ajungem la media grupului Visegrad, care este ilustrată în tabelul următor:\n\n\nArată codul\nagregate %>% filter(grepl(\"Total general government revenue\", na_item)) %>% \n  filter(grepl(\"Romania|Cehia|Slovacia|Ungaria|Polonia\", geo)) %>% \n  spread(geo, values) %>% \n  mutate(delta = -Romania + (Cehia + Polonia + Slovacia + Ungaria)/4) %>% \n  select(-1) %>% filter(time>\"2011-01-01\") %>% rename(Anul=time) %>% \n  gt::gt() %>% gtExtras::gt_theme_538() %>% \n  tab_header(title=\"Bugetul total pentru România şi Vişegrad\", \n             subtitle=\"Sursa: Eurostat, gov_10a_main\") %>% opt_row_striping() %>%\n  gt::tab_footnote(footnote=\"Diferenţa dintre media Vişegrad şi România\", \n               locations=cells_column_labels(columns=delta)) %>%\n  gtExtras::gt_color_rows(columns=2:7) %>%\n  gt::fmt_percent(columns=2:7, decimals=2, scale_values = F) %>%\n  gt::opt_table_font(font='Frutiger') %>%\n  tab_style(cell_text(font=\"Frutiger Bold\"), cells_title(groups=\"title\")) %>%\n  gt::tab_style(style=cell_fill(color=culori[1]), locations=cells_column_labels()) %>%\n  gt::tab_style(style=cell_text(color='white'), locations=cells_column_labels())\n\n\n\n\n\n\n  \n    \n      Bugetul total pentru România şi Vişegrad\n    \n    \n      Sursa: Eurostat, gov_10a_main\n    \n    \n      Anul\n      Cehia\n      Polonia\n      Romania\n      Slovacia\n      Ungaria\n      delta1\n    \n  \n  \n    2012-01-01\n40.80%\n39.60%\n32.30%\n36.80%\n46.80%\n8.70%\n    2013-01-01\n41.40%\n39.10%\n33.70%\n39.60%\n47.50%\n8.20%\n    2014-01-01\n40.50%\n39.20%\n34.20%\n40.20%\n47.30%\n7.60%\n    2015-01-01\n41.30%\n39.10%\n35.50%\n42.90%\n48.40%\n7.43%\n    2016-01-01\n40.50%\n38.90%\n32.50%\n40.00%\n45.00%\n8.60%\n    2017-01-01\n40.50%\n39.90%\n31.10%\n38.50%\n44.30%\n9.70%\n    2018-01-01\n41.50%\n41.20%\n31.70%\n38.70%\n44.00%\n9.65%\n    2019-01-01\n41.30%\n41.10%\n31.60%\n39.30%\n44.00%\n9.82%\n    2020-01-01\n41.50%\n41.30%\n32.30%\n39.40%\n43.60%\n9.15%\n    2021-01-01\n41.40%\n42.30%\n32.70%\n40.10%\n41.20%\n8.55%\n    2022-01-01\n41.00%\n39.80%\n33.50%\n40.20%\n41.60%\n7.15%\n  \n  \n  \n    \n      1 Diferenţa dintre media Vişegrad şi România\n    \n  \n\n\n\n\nObservăm că suntem cu circa 7.5 -8 % procente din PIB în urma grupului Vişegrad la veniturile totale, şi asta în vremurile bune. Făcând o medie pe ultimii zece ani, avem o diferenţă de circa 28 miliarde de EURO (nu RON !) faţă de media acestui grup.\n\n\nArată codul\ntaxe %>% filter(grepl(\"Total tax\", na_item)) %>% \n    filter(grepl(\"Romania|Cehia|Slovacia|Ungaria|Polonia\", geo)) %>% \n    spread(geo, values) %>% \n    mutate(medie = (Cehia + Polonia + Slovacia + Ungaria)/4) %>% \n    select(-1) %>% filter(time>\"2011-01-01\") %>% rename(Anul=time) %>% \n    drop_na() %>% select(Anul, Romania, medie) %>% \n    gather(2:3, key=\"Indicator\", value='valoare') %>% \n    ggplot(aes(x=Anul, y=valoare, group=Indicator)) + \n    geom_line(aes(colour=Indicator), size=1) + \n    labs(title=\"Veniturile fiscale: media Vişegrad şi România\", \n         x=NULL, y=\"% din PIB\", colour=\"Regiune\", \n         caption=\"Sursa: Eurostat, gov_10a_taxag\") +  \n    scale_color_manual(values=culori[c(1, 5)]) +\n    theme(legend.position = 'top')"
  },
  {
    "objectID": "ratele_impozitarii.html",
    "href": "ratele_impozitarii.html",
    "title": "2  Analiza ratelor impozitării",
    "section": "",
    "text": "În acest raport vom încerca să investigăm impactul cotei progresive asupra încasărilor din impozitul pe venit. În acest scop vom ilustra înainte mai multe trenduri ale taxării pentru a ne familiariza cu datele. Vom începe prin a ilustra o metrică ce ţine indirect de povara taxării pe venit, anume rata de taxare efectivă pentru persoana singură ce câştigă salariul mediu pe economie. Sursa datelor e indicată în subtitlul graficului.\n\n\nArată codul\nlibrary(Matrix)\nlibrary(tidyverse)\nlibrary(eurostat)\nlibrary(patchwork)\nlibrary(gt)\nlibrary(furrr)\nlibrary(CausalImpact)\nplan(\"multisession\")\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#ffe0c2\", \"#0865a4\", \"#a48408\")\n\ntaxe <- read_csv(here::here(\"database\", \"taxare_efectiva_venit.csv\"))\ndf <- read_csv(here::here(\"database\", \"income_profit_gdp_inflation.csv\"))\n\n\n\n\nArată codul\n#rata de taxare efectivă\ntaxe %>% filter(time%in%c(2010, 2020)) %>% \n  arrange(time) %>% mutate(time=as.factor(time)) %>% \n  mutate(geo = gsub(\"\\\\(.+\\\\)\", \"\", geo)) %>%\n  filter(!grepl(\"Media|Cipru|Croatia\", geo)) %>%\n  mutate(geo=fct_reorder(geo, ef_rate)) %>%\n  ggplot(aes(x=geo, y=ef_rate, group=time)) +\n  geom_col(aes(fill=time), position='dodge') + coord_flip() +\n  labs(title= \"Rata de taxare efectivă\", \n       subtitle = \"Persoană singură cu venitul mediu\",\n       y=\"Rata de taxare efectivă\", x=\"Ţară\", fill=\"Anul\", \n       caption=\"Sursa: Eurostat, earn_nt_taxrate\") +\n  scale_y_continuous(labels = scales::percent_format(scale=1)) +\n  scale_fill_manual(values=culori[c(1, 5)]) +\n  theme(legend.position = 'top')\n\n\n\n\n\nObservăm din acest grafic că Belgia, Germania şi Danemarca sunt ţările cu cea mai mare rată a taxării efective, România ocupând efectiv locul al 6-lea ! Trebuie menţionat însă că metrica această calculată de Eurostat ia în calcul şi contribuţiile plătite de angajat, nu de angajator, motiv pentru care pare că România a avut o creştere semnificativă a taxării efective în 2020 (din cauza unor artificii fiscale din 2018), deşi în realitate taxarea a coborât. Lituania, spre exemplu, cunoaşte o creştere mare a taxării efective în 2020 datorită trecerii la cota progresivă în 2019.\nAcum vom vizualiza relaţia încasări din impozitul pe profit vs încasări din impozitul pe venit şi vom împărţi (prin metoda *k-means*) ţările în patru clusteri. Am ales o diferenţă de 5 ani între cele două perioade afişate astfel încăt să excludem şi impactul crizei economice din 2008-2009 dar şi al pandemiei de COVID din 2020. Aşadar, în acest grafic apar anii 2014 şi 2019.\n\n\nArată codul\nsegmente <- df %>% \n  select(geo, time, income_revenues, profit_revenues) %>% \n  filter(time%in%c(2014,2019)) %>% \n  pivot_wider(names_from=time, values_from = c(income_revenues, profit_revenues))\n\ndf %>% filter(time%in%c(2014, 2019)) %>% \n  mutate(time=as.factor(time)) %>% mutate(id=paste(geo, time)) %>% \n  select(-1,-2) %>% relocate(id) %>% select(1, 2, profit_revenues) %>% \n  column_to_rownames(\"id\") %>% kmeans(centers=5) %>% .[[1]] %>% \n  enframe() %>% separate(name, into=c(\"geo\", \"time\"), sep=\" \") %>% \n  inner_join(df %>% filter(time%in%c(2014, 2019)) %>% \n             mutate(time=as.character(time))) %>% rename(cluster=value) %>%\n  mutate(cluster=as.factor(cluster)) %>% \n  ggplot(aes(x=income_revenues, y=profit_revenues, group=time)) + \n  ggConvexHull::geom_convexhull(aes(x=income_revenues, y=profit_revenues, \n                                    group=cluster, fill=cluster), alpha=0.4) +\n  geom_point(aes(colour=time, shape=time, size=geo==\"Romania\"), \n             show.legend = c(\"size\"=FALSE))  +\n  geom_segment(data=segmente, inherit.aes = F,\n               aes(x=income_revenues_2014, xend=income_revenues_2019, \n                   y=profit_revenues_2014, yend=profit_revenues_2019), \n               linetype=2, colour=\"grey50\") +\n  labs(title=\"Încasările din taxa pe profit versus venit\", subtitle=\"% din PIB\", \n       x=\"Venit individual şi gospodării\", y=\"Profit\", colour=\"An\", shape=\"An\", fill=\"Cluster\", caption=\"Sursa: Eurostat, gov_10a_taxag\") +\n  ggrepel::geom_text_repel(aes(label=geo, size=geo==\"Romania\"), \n                           max.overlaps = 7, show.legend = c(\"size\"=FALSE)) +\n  scale_fill_manual(values = culori) +\n  scale_x_continuous(labels=scales::percent_format(scale=1)) +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_size_manual(values=c(3, 4))\n\n\n\n\n\nÎn continuare vom vizualiza cea mai mare rată a taxării marginale pentru fiecare ţară şi cum a variat în timp. Vom folosi datele de la OECD întrucât Eurostat nu are informaţii de acest gen. Dar menţionez că apar nişte discrepanţe între datele acestea şi ce mai spune Google.\n\n\nArată codul\nrate <- read_csv(here::here(\"database\", \"rate_praguri_venit_oecd_total.csv\"))\n\nrate %>% \n  ggplot(aes(x=Year, y=Value, group=geo)) +\n  geom_line(aes(colour=geo)) + \n  labs(title=\"Cea mai mare rată a taxării marginale\", \n       x=\"An\", y=\"% din venit\", caption=\"Sursa: OECD, Tabelul I.7\", \n       colour=\"Ţară\") + \n  gghighlight::gghighlight(geo%in%c(\"Ungaria\", \"Polonia\", \"Danemarca\", \n                                    \"Austria\", \"Spania\", \"Italia\"),\n                           use_direct_label = F) +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  scale_color_manual(values=culori[-6])"
  },
  {
    "objectID": "ratele_impozitarii.html#analiza-statistică",
    "href": "ratele_impozitarii.html#analiza-statistică",
    "title": "2  Analiza ratelor impozitării",
    "section": "2.2 Analiza statistică",
    "text": "2.2 Analiza statistică\nPentru început vom analiza longitudinal variaţia încasărilor din taxele pe venit folosind un model din categoria “latent growth curve” de tip bayesian. Modelul asumă intercepturi şi pante random pentru fiecare ţară în parte. Dar mai întâi o ilustraţie grafică cu datele brute.\n\n\nArată codul\ndf %>% #filter(!grepl(\"Croatia|Elvetia\", geo)) %>% \n  ggplot(aes(x=time, y=income_revenues, group=geo)) + \n  geom_line(aes(colour=geo), size=0.9) + \n  scale_y_continuous(labels = scales::percent_format(scale=1)) + \n  gghighlight::gghighlight(geo%in%c(\"Romania\", \"Bulgaria\", \"Cehia\", \n                                    \"Franta\", \"Ungaria\", \"Spania\")) + \n  labs(title=\"Încasările din impozitul pe venit\", \n       x=NULL, y=\"Procent din PIB\", \n       caption=\"Sursa: Eurostat, gov_10a_taxag\") + \n  scale_color_manual(values=culori[-6]) \n\n\n\n\n\nMai jos ilustrăm rezultatele (parametrii) modelului. Mai întâi valorile pantelor. Interpretarea este simplă, panta este valoarea medie anuală cu care cresc (sau scad) încasările din impozitul pe venit. Fiecare ţară are câte o pantă şi un intercept. Interceptul este valoarea din anul 1998, anul cu care începe analiza noastră şi pentru care avem datele. Practic este punctul de plecare al ţării respective. Modelul mai furnizează şi corelaţia dintre pante şi intercepturi. Dacă corelaţia e pozitivă, înseamnă că ţările care încasau la început mai mult au crescut în continuare şi mai repede decât media celorlalte, dacă este negativă, înseamnă că există un fenomen de convergenţă - cele care încasau puţin cresc mai mult decât cele care încasau de la început mai mult.\n\n\nArată codul\nmodel <- read_rds(here::here(\"model.R\"))\n\nbrms::as_draws_df(model) %>%  \n  select(contains(\"year\")) %>% \n  select(-contains(\"sd\"), -contains(\"cor\"), -contains(\"b_year\")) %>% \n  mutate(id=row_number()) %>% select(id, contains(\"geo\")) %>%\n  relocate(id) %>% gather(2:28, key='param', value='value') %>% \n  mutate(param = str_extract(string = param, \n                             pattern=\"(?<=\\\\[)[a-zA-Z\\\\s]+(?=,year)\")) %>%\n  drop_na() %>% group_by(param) %>% mutate(medie=mean(value)) %>% \n  ungroup() %>% arrange(desc(medie)) %>% mutate(param=fct_reorder(param, medie)) %>%\n  ggplot(aes(x=value, y=param, group=param)) + \n  ggridges::geom_density_ridges(fill='#EA5B0C', alpha=0.7, colour=NA) + \n  geom_vline(xintercept = 0, linetype=2, colour='#a40e08', linewidth=1) +\n  labs(title=latex2exp::TeX(\"$Valoarea\\\\,coeficienţilor\\\\,β_{1}^{ţară}$\"), \n       x=\"% per an\", y=\"Ţară\", subtitle=\"Viteza de creştere/descreştere a încasărilor\", \n       caption =\"Sursa: calcule pe baza Eurostat, gov_10a_taxag\")\n\n\n\n\n\nŞi intercepturile:\n\n\nArată codul\nbrms::as_draws_df(model) %>%  \n  select(contains(\"Intercept\")) %>% \n  select(-contains(\"sd\"), -contains(\"cor\"), -contains(\"b_Intercept\")) %>% \n  mutate(id=row_number()) %>% select(id, contains(\"geo\")) %>%\n  relocate(id) %>% gather(2:28, key='param', value='value') %>% \n  mutate(param = str_extract(string = param, pattern=\"(?<=\\\\[)[a-zA-Z\\\\s]+(?=,Intercept)\")) %>%\n  drop_na() %>% group_by(param) %>% mutate(medie=mean(value)) %>% \n  ungroup() %>% arrange(desc(medie)) %>% mutate(param=fct_reorder(param, medie)) %>%\n  ggplot(aes(x=value, y=param, group=param)) + \n  ggridges::geom_density_ridges(fill='#EA5B0C', alpha=0.7, colour=NA) + \n  geom_vline(xintercept = 0, linetype=2, colour='#a40e08', linewidth=1) +\n  labs(title=latex2exp::TeX(\"$Valoarea\\\\,coeficienţilor\\\\,β_{0}^{ţară}$\"), \n       x=\"% per an\", y=\"Ţară\", subtitle=\"Intercepturi \", \n       caption =\"Sursa: calcule pe baza Eurostat, gov_10a_taxag\")\n\n\n\n\n\nCorelaţia dintre intercepturi şi pante este de -0.08, nefiind semnificativă statistic.\n\n2.2.1 Impactul cotei progresive asupra încasărilor\nNe vom axa pe cele patru ţări care au abandonat cota unică: Lituania în 2019, Letonia în 2018, Cehia şi Slovacia în 2013.\nPentru Lituania (2019):\n\nAceasta a avut următorul parcurs: 33% cotă unică introdusă în 1995, 27% în 2006, 24% în 2008 şi 15% in 2009. În 2019 a trecut la cota progresivă cu praguri de 20 % şi 27 %.\n\nPentru Letonia (2018):\n\nAceasta a avut următorul parcurs: cotă unică de 25% în 1997. 23 % în 2009, 26% în 2010, 25% în 2011, 24% în 2013, şi 23% in 2015. în 2018, a trecut la impozitul progresiv cu cote de 20%, 23% şi 31.4%.\n\nPentru Cehia (2013):\n\nCehia a introdus în 2008 o cotă unică pe venit de 15 % care s-a aplicat şi contribuţiilor sociale (cam 20 % pe venitul din muncă per ansamblu). În 2013 a adaugat o cotă de 22 % pentru cei ce depăşeau limita contribuţiilor trecând practic la impozit progresiv. Deci impactul e mai mic în cazul aceasta spre deosebire de Lituania\n\nPentru Slovacia (2013):\n\nCota unică de 19 % introdusă în 2004 şi impozit progresiv introdus în 2013 cu cote de 19 % şi 25 %.\n\nNe-am aştepta să vedem cele mai mari efecte la Lituania şi Slovacia.\n\n\nArată codul\ndf %>% \n  mutate(time=paste0(time,\"-01-01\") %>% as.Date()) %>%\n  filter(grepl(\"Slovacia|Cehia|Lituania|Letonia\", geo)) %>% \n  mutate(index = case_when(geo==\"Cehia\" ~ as.Date(\"2013-01-01\"),\n                           geo==\"Lituania\" ~ as.Date(\"2019-01-01\"),\n                           geo==\"Letonia\" ~ as.Date(\"2018-01-01\"),\n                           geo==\"Slovacia\" ~ as.Date(\"2013-01-01\"))) %>%\n  ggplot(aes(x=time, y=income_revenues)) + geom_line(colour='#EA5B0C', size=1) + \n  geom_vline(aes(x=time, y=income_revenues, xintercept=index), \n             linetype=2, colour='grey50') +\n  facet_wrap(~geo, ncol=2, scales='free') + \n  labs(title = \"Încasările din impozitul pe venit în cele patru ţări\", \n       x=\"An\", y=\"Procent din PIB\", caption=\"Sursa: Eurostat, gov_10a_taxag\") +\n  scale_y_continuous(labels=scales::percent_format(scale=1))\n\n\n\n\n\nAparent ar exista un impact pozitiv al cotei progresive asupra încasărilor din impozitul pe venit … însă e foarte important să ne uităm în paralel şi la încasările totale… dacă acestea cresc odată cu încasările din taxa pe venit e clar că există o altă variabilă, alta decât rata taxării pe venit, care le influenţează pe amândouă, căci logic vorbind rata taxării pe venit nu ar trebui să influenţeze colectarea taxelor pe profit, pe mediu, TVA sau oricare altă taxă în afara de cea pe venit. Vom standardiza datele ca să putem să le suprapunem şi să observăm dacă au acelaşi trend.\n\n\nArată codul\ndf <- read_csv(here::here(\"database\", \"income_profit_gdp_inflation.csv\")) %>%\n      inner_join(read_csv(here::here(\"database\", \"taxe_total.csv\")) %>%\n      mutate(time=lubridate::year(time))) %>%\n      mutate(taxe_total = taxe_total - income_revenues)\n\ndf %>% \n  mutate(time=paste0(time,\"-01-01\") %>% as.Date()) %>%\n  filter(grepl(\"Slovacia|Cehia|Lituania|Letonia\", geo)) %>% \n  mutate(index = case_when(geo==\"Cehia\" ~ as.Date(\"2013-01-01\"),\n                           geo==\"Lituania\" ~ as.Date(\"2019-01-01\"),\n                           geo==\"Letonia\" ~ as.Date(\"2018-01-01\"),\n                           geo==\"Slovacia\" ~ as.Date(\"2013-01-01\"))) %>%\n  group_by(geo) %>%\n  mutate(across(c(income_revenues, taxe_total), \n                ~(.-mean(.))/sd(.))) %>%\n  ungroup() %>%\n  select(geo, time, index, income_revenues, taxe_total) %>% \n  rename(`Impozit venit`=income_revenues, `Total taxe`=taxe_total) %>%\n  gather(c(`Impozit venit`, `Total taxe`), \n         key=\"Indicator\", value=\"valoare\") %>%\n  ggplot(aes(x=time, y=valoare, group=Indicator)) +  \n  geom_line(aes(x=time, y=valoare, colour=Indicator), size=1) +\n  geom_vline(aes(x=time, y=valoare, group=Indicator, xintercept=index), \n             linetype=2, colour='grey50') +\n  facet_wrap(~geo, ncol=2, scales='free') + \n  labs(title = \"Impozit pe venit vs total taxe în cele patru ţări\", \n       x=\"An\", y=\"Deviaţii standard în jurul mediei\", \n       subtitle=\"Date standardizate\", \n       caption=\"Sursa: calcule pe Eurostat, gov_10a_taxag\") +\n  scale_colour_manual(values = culori[c(1, 5)]) +\n  theme(legend.position = 'top')\n\n\n\n\n\nAparent este cazul pentru toate tările noastre. Cel puţin parţial, acolo unde a crescut încasarea din taxa pe venit au urcat şi încasările din restul taxelor. Menţionam că ce apare în grafic ca taxe “totale” sunt taxele totale minus încasările din taxa pe venit, adică încasările din restul taxelor. Ca să calculăm impactul “cauzal” al cotei progresive asupra încasărilor din taxa pe venit, putem folosi restul încasărilor ca procent din PIB ca serie de control (ajustăm la ea). Vom folosi un model dezvoltat de Kay H. Brodersen et al (2015), din categoria modelelor structurale bayesiene de serii de timp. Vom folosi încasările din restul taxelor şi creşterea procentuală a PIB ca serii de control. Altfel spus, vom prezice ce s-ar fi întâmplat în absenţa trecerii la cota progresivă şi vom sustrage astfel efectul obţinut. Ca să pretindem că efectul obţinut este cauzal trebuie să respectăm următoarele premize:\n\nNu au existat alte lucruri care s-au întâmplat concomitent cu taxarea progresivă, deci nu au existat alte intervenţii omise din model.\nSeriile de control prezic variabila-răspuns (încasările din taxa pe venit) dar nu sunt influenţate la rândul lor de intervenţie. (în cazul PIB-ului s-ar putea argumenta că lucrurile nu stau aşa)\nRelaţia pe care au o seriile de control cu variabila-răspuns rămâne aceeaşi înainte şi după intervenţie.\n\nÎn cazul nostru putem să ne plângem doar de lipsa unor controale mai bune, îşi de numărul limitat de observaţii, nsă în rest respectăm aproximativ premizele. Să vizualizăm impactul cotei progresive asupra încasărilor în cele patru ţări. Graficele se citesc în modul următor: primul subgrafic cu negru reprezintă încasările din taxa pe venit, seria de timp originală sau variabila-răspuns. Cu roşu punctat este seria prezisă de model (şi fit-ul ei) în absenţa intervenţiei. În al doilea subgrafic avem impactul “cauzal” iar în al treilea impactul “cauzal” cumulativ. Predicţiile furnizat de model vin şi cu intervale ‘credibile’ (în limbajul statisticii bayesiene) de 95 %.\n\n\nArată codul\nprag <- c(\"Slovacia\"=11, \"Lituania\"=17, \"Letonia\"=16, \"Cehia\"=11)\n\n\nplot.CausalImpact <- function(model){\n  x <- as_tibble(model$series) %>% \n       mutate(time = 2002:2021) %>% relocate(time)\n  g1 <- x %>% ggplot(aes(x=time, y=response)) + \n    geom_line(size=1) + \n    geom_line(aes(x=time, y=point.pred), colour=culori[2], linetype=2) +\n    geom_vline(xintercept = x$time[model$model$pre.period[2]] + 1, linetype=2, \n               colour='grey50') +\n    geom_ribbon(aes(x=time, ymin=point.pred.lower, ymax=point.pred.upper), \n                alpha=0.3, fill=culori[1]) +\n    labs(caption=\"Seria originală împreună cu contrafactualul\", x=NULL)\n  \n  g2 <- x %>% ggplot(aes(x=time, y=point.effect)) + \n    geom_line(linetype=2, colour=culori[1]) + \n    geom_ribbon(aes(x=time, ymin=point.effect.lower, \n                    ymax=point.effect.upper), alpha=0.3, fill=culori[1]) +\n    geom_vline(xintercept=x$time[model$model$pre.period[2]] + 1, linetype=2, \n               colour='grey50') +\n    geom_hline(yintercept=0, linetype=2) +\n    labs(caption=\"Impactul renunţării la cota unică\", x=NULL) +\n    theme(plot.margin = margin(-1, 0.5, -2, 0.5, \"cm\"))\n  g1 / g2\n}\n\n\nextrage_geo <- function(tara, df){\n  x <- df %>% dplyr::select(geo, time, income_revenues, GDP, taxe_total) %>%\n    filter(geo==tara) %>% arrange((time)) %>%\n    select(-geo) %>% rename(y=income_revenues) %>%\n    column_to_rownames(\"time\") \n  return(x)\n}\n\nmodel <- list()\nfor(i in names(prag)){\nmodel[[i]] <- CausalImpact(extrage_geo(names(prag[i]), df=df), \n                      pre.period = c(1, prag[i]), \n                      post.period=c(prag[i]+1, 19), \n                      model.args = list(niter=3000))\n}\n\nplot(model$Slovacia) + \n    patchwork::plot_annotation(title=\"Slovacia (2013)\", \n    subtitle=\"Impactul trecerii la cota progresivă \\nasupra veniturilor din taxa pe venit\", caption=\"Sursa: calcule pe Eurostat, gov_10a_taxag\")\n\n\n\n\n\nÎn Slovacia avem cel mai clar o dovada a creşterii încasărilor ca urmare a cotei progresive.\n\n\nArată codul\nplot(model$Lituania) + \n  patchwork::plot_annotation(title=\"Lituania (2019)\", \n  subtitle=\"Impactul trecerii la cota progresivă \\nasupra veniturilor din taxa pe venit\", caption=\"Sursa: calcule pe Eurostat, gov_10a_taxag\")\n\n\n\n\n\nÎn Lituania deşi avem o creştere marcată a încasărilor din impozitul pe venit fix în anul trecerii la cota progresivă, avem o creştere semnificativă şi a celorlalte încasări de taxe, deci impactul “cauzal” calculat de model rămâne mai mic.\n\n\nArată codul\nplot(model$Letonia) + \n  patchwork::plot_annotation(title=\"Letonia (2018)\", \n  subtitle=\"Impactul trecerii la cota progresivă \\nasupra veniturilor din taxa pe venit\", caption=\"Sursa: calcule pe Eurostat, gov_10a_taxag\")\n\n\n\n\n\nÎn Letonia nu avem niciun impact decelabil.\n\n\nArată codul\nplot(model$Cehia) +\n  patchwork::plot_annotation(title=\"Cehia (2013)\", \n  subtitle=\"Impactul trecerii la cota progresivă \\nasupra veniturilor din taxa pe venit\", caption=\"Sursa: calcule pe Eurostat, gov_10a_taxag\")\n\n\n\n\n\nÎn Cehia avem un efect întârziat cu aproximativ 3-4 ani care ar putea fi atribuit altor măsuri."
  },
  {
    "objectID": "ratele_impozitarii.html#impozitul-pe-profit",
    "href": "ratele_impozitarii.html#impozitul-pe-profit",
    "title": "2  Analiza ratelor impozitării",
    "section": "2.3 Impozitul pe profit",
    "text": "2.3 Impozitul pe profit\nÎn această secţiune vom analiza impozitul pe profit şi impactul lui asupra încasărilor. Spre deosebire de cel pe venit, acesta se schimbă semnificativ mai frecvent şi nu avem o singură intervenţie pe care să o putem cuantifica. De asemenea avem şi număr mic de puncte pentru a putea testa ipoteze prin metoda ecuaţiilor structurale sau chiar şi pentru o banală analiză regresivă. Ne vom limita aşadar doar la analize exploratorii.\n\n\nArată codul\ncorporate_rate <- read_csv(here::here(\"database\",\n                                      \"income_profit_gdp_inflation.csv\"))\n\nggplot(corporate_rate,aes(x=time, y=profit_rate, group=geo)) + \n  geom_line(aes(colour=geo), size=0.9) + \n  gghighlight::gghighlight(geo%in%c(\"Romania\", \"Bulgaria\", \"Polonia\", \n                                    \"Cehia\", \"Slovacia\", \"Ungaria\"), \n                           use_direct_label = F) +\n  scale_y_continuous(labels=scales::percent_format(scale=1)) +\n  labs(title=\"Rata impozării pe profitul companiilor\", x=\"An\", \n       y=\"Procent din profit\", caption =\"Sursa: TaxFoundation\", colour=\"Ţară\") +\n  scale_color_manual(values=culori[-6])\n\n\n\n\n\nObservăm că mai toate sunt în scădere. Efectul a treizeci de ani de neoliberalism.\n\n\nArată codul\nculorile <- c(\"2010\"=culori[1], \"2020\"=culori[5])\n\ncorporate_rate %>% filter(time%in%c(2010, 2020)) |> \n  select(geo, time, profit_rate) |>\n  spread(time, profit_rate) |> mutate(medie=(`2020`+`2010`)/2, \n                                      geo=fct_reorder(geo, medie)) |> \n  ggplot(aes(x=geo, y=`2010`)) + \n  geom_segment(aes(x=geo, xend=geo, y=`2010`, yend=`2020`)) + \n  geom_point(aes(colour=\"2010\"), size=2) + \n  geom_point(aes(x=geo, y=`2020`, colour=\"2020\"), size=2) + \n  coord_flip() + labs(title=\"Impozitul pe profit\", \n                      subtitle=\"% din PIB\", \n                      caption=\"Sursa: TaxFoundation\", \n                      y=\"Rata taxării\", x=\"Ţară\", colour='Ani') + \n  scale_y_continuous(labels = scales::percent_format(scale=1)) + \n  scale_color_manual(values=culorile)\n\n\n\n\n\nAcelaşi lucru se vede şi aici. În continuare urmărim trendurile dintre încasări şi rata impozitării şi creşterea PIB-ului. Din nou, vom standardiza datele ca să le putem vizualiza în axă comună.\n\n\nArată codul\ntari <- c(\"Polonia\", \"Ungaria\", \"Cehia\", \"Slovacia\", \n          \"Letonia\", \"Lituania\", \"Romania\", \"Bulgaria\")\n\ncorporate_rate %>% filter(geo%in%tari) %>%\n    group_by(geo) %>% \n  mutate(across(GDP:profit_rate, ~(.-mean(.))/sd(.))) %>% \n  rename(`Impozit colectat`=profit_revenues, PIB=GDP,\n         `Rata impozitării`=profit_rate) %>%\n  gather(PIB:`Rata impozitării`, \n         key='var', value='valoare') %>%\n  ggplot(aes(x=time, y=valoare, colour=var)) + geom_line(aes(colour=var)) +\n  facet_wrap(~geo, ncol=2, scales='free') + \n  labs(title=\"Rata impozitării profitului vs încasări\", \n       x=NULL, caption=\"Sursa: calcule pe Eurostat, gov_10a_taxag şi TaxFoundation\", \n       y=\"Deviaţii standard în jurul mediei\", colour='Indicator') +\n  scale_color_manual(values = culori[c(1, 4, 8)]) +\n  theme(legend.position = 'top')\n\n\n\n\n\nDin acestă imagine nu trebuie să se tragă concluzia, falsă, cum că rata impozitării ar influenţa negativ creşterea PIB-ului pentru că par invers corelate din grafic. Aici avem de-a face cu dependenţa PIB-ului de PIB-ul anterior… El creşte oricum independent de variabilele noastre, dar pentru a testa relaţia rată-> PIB avem nevoie de serii de timp mult mai lungi decât avem. Pentru a nu induce în eroare încălcând norme metodologice am ales să nu includ aici o asemenea analiză."
  },
  {
    "objectID": "ratele_impozitarii.html#scenarii-de-impozitare-progresivă",
    "href": "ratele_impozitarii.html#scenarii-de-impozitare-progresivă",
    "title": "2  Analiza ratelor impozitării",
    "section": "2.4 Scenarii de impozitare progresivă",
    "text": "2.4 Scenarii de impozitare progresivă\nÎn această secţiune investigăm diferite scenarii de impozitare progresivă pentru România. Singura bază de date care are datele suficient de granulare este World Inequality Database. Are date la nivel de percentile cu media venitului pre-taxe (şi post-taxe, dar nu ne interesează aici) per percentilă.\nPentru a explora diferite scenarii de impozitare progresivă am creat următoarea aplicaţie. Singura constantă este faptul că impozitarea este constrânsă la trei trepte (cred că este rezonabil pentru România), restul fiind variabile ce pot fi explorate. Jos este un grafic care explorează asemenea posibilităţi asumând pragul pentru cea de a treia cotă la nivelul câştigului salarial brut de 2200 EURO (top 8-9 % conform distribuţiei veniturilor salariale din baza de date a World Inequality Database, iar pentru prima cotă, care rămâne 10 %, la 600 EURO (salariul minim din 2023).\n\n\nArată codul\ndistrib_wid <- read_delim(here::here(\"database\", \"WID\", \"WID_data_RO.csv\")) %>% \n  filter(variable==\"aptincj992\") %>% filter(year==2021) %>% \n  filter(country==\"RO\") %>% select(percentile, value) \n\npe <- numeric(100)\nfor(i in 1:100){\n  pe[i] <- paste0(\"p\", i-1, \"p\", i)\n}\n\ndistrib_wid <- distrib_wid %>% filter(percentile%in%pe) %>% \n  mutate(percentile = as.factor(percentile)) %>% \n  mutate(percentile = factor(percentile, levels=pe, ordered=T)) %>% \n  arrange(percentile)\n\ndistrib_wid %>% \n  filter(between(value, 2100*5*12, 2300*5*12)) %>% pull(percentile)\n\n\n[1] p91p92\n100 Levels: p0p1 < p1p2 < p2p3 < p3p4 < p4p5 < p5p6 < p6p7 < p7p8 < ... < p99p100\n\n\nPragul a fost împrumutat de la Slovacia: pragul la ei este de 38000 EURO brut anual. Ajustat la PIB-ul per capita, la noi ar veni 2200 EURO brut lunar. Vom folosi acest prag pentru patru mari scenarii. Puteţi explora toate scenariile, folosind fie aplicaţia (care permite şi alt prag) fie imaginea interactivă de mai jos care fixează pragul la 2200 EURO şi lasă cotele să varieze. Puteţi afla suma strânsă totala din impozit multiplicând factorul din grafic sau aplicaţie cu 28 miliarde de RON (impozitul pe venitul din salarii din 2021, conform MF). Noi vom propune patru scenarii în cele ce urmează. Toate vor avea rată de 10 % pe ultimii 30 % din distribuţie (sub 3000 RON brut anual, salariul minim practic).\n\n\nArată codul\nraport_wid <- function(valori, coefs, praguri){\n  x <- distrib_wid %>% mutate(categ = row_number()) %>% \n    mutate(value_2=lead(value)) %>% mutate(value_2=replace_na(value_2, 100000000))\n  \n  k1 <- x %>% filter(60*praguri[1] > value, 60*praguri[1] < value_2) %>% \n    pull(categ) %>% .[1] %>% as.integer()\n  k2 <- x %>% filter(60*praguri[2] > value, 60*praguri[2] < value_2) %>%\n    pull(categ) %>% .[1] %>% as.integer()\n  \n  if(valori < 60*praguri[1]){\n    imp <- coefs[1]*valori\n  } else if(valori > 60*praguri[1] && valori < 60*praguri[2]){\n    imp <- coefs[1]*60*praguri[1] + coefs[2]*(valori-60*praguri[1])\n  } else if(valori > 60*praguri[2]){\n    imp <- coefs[1]*60*praguri[1] + coefs[2]*(60*praguri[2]-60*praguri[1]) +\n      coefs[3]*(valori-60*praguri[2])\n  }\n  return(c(imp, as.integer(100-k1), as.integer(100-k2)))\n}\n\n\n\n\nArată codul\ninsumare <- function(coefs, praguri){\nimp_total <- numeric(100)\nfor(i in 1:100){\n  imp_total[i] <- raport_wid(valori = distrib_wid$value[i], \n                  coefs=coefs, praguri=praguri)[1]\n}\nmessage(\"Gata\")\nsum(imp_total)*47000/1000000000\n}\n\n\n\n\nArată codul\nmultiplicator <- expand_grid(\"cota_1\"=0.1,\n                             \"cota_2\"=seq(0.1, 0.5, by=0.02), \n                              \"cota_3\"=seq(0.1, 0.5, by=0.02)) %>% \n  mutate(coefs = pmap(list(cota_1, cota_2, cota_3), c)) %>% \n  mutate(ratio = future_map_dbl(coefs, \n                         ~insumare(.x, praguri=c(600, 2200))/28)) %>% \n  mutate(ratio2 = cut(ratio, breaks=c(-0.01, 1, 1.5,  2, 2.5, 3, 3.5, 4, 4.5 ,5, 10))) %>% \n  ggplot(aes(x=cota_2, y=cota_3, fill=ratio2, \n             text=paste(\"Raport:\", round(ratio, 3)))) + \n  geom_tile(colour='white') +\n  scale_fill_viridis_d(option=\"E\") +\n  scale_x_continuous(labels=scales::percent_format()) +\n  scale_y_continuous(labels=scales::percent_format()) +\n  labs(title = \"Factorul multiplicativ al încasărilor\", \n       x=\"Prima cotă\", y=\"A doua cotă\", fill=\"Factor\")\n\nplotly::ggplotly(multiplicator)\n\n\n\n\n\n\nSugestia noastră finală este un scenariu intermediar între cel slovac şi cel cu progresivitate scăzută de 10 % - 16 %: anume cotă de 16 % ( în loc de 19 %) şi 21 % (în loc de 25 %) pentru tot ce trece de prag. Rate marginale, nu efective.\n\n2.4.1 Cele patru scenarii\nVom calcula sumele colectate ca impozit pe venit folosind distribuţiile la nivel de percentilă ale datelor furnizate de World Inequality Database. Datele WID sunt furnizate până la anul 2021, deci avem avantajul dublu al unei distribuţii mai recente şi mai fine decât permit alte baze de date (Eurostat, ILOSTAT, etc). Vom considera de asemenea că avem 4.7 milioane de salariaţi plătitori de impozit de venit (aproximativ 1 milion sunt scutiţi). Impactul scutirilor va fi calculat separat. De asemenea, costul unui credit fiscal pentru ultimii 10 % ai distribuţiei (sub 100 euro brut lunar) este de circa 2.5 miliarde. El se poate scădea din toate sumele afişate ulterior în acest document.\n\n\n2.4.2 Scenariul I\nCote de 10 % şi 16 % pe orice sumă care depăşeşte 2200 EURO brut. Se strâng în total 33.73 miliarde RON, cu 5.73 miliarde mai mulţi bani decât în 2021. Îl vom rotunji la 5 miliarde RON, notând că valoarea va fi mult mai mare în 2023, aşa ne luăm o marjă de eroare semnificativă.\n\n\n2.4.3 Scenariul II\nCote de 10 şi 19 % pe orice sumă depăşeşte 2200 EURO brut. Se strâng 35.59 miliarde RON. Acest lucru înseamnă încă 7.5 miliarde de RON la buget. Îl vom rotunji la 7 miliarde.\n\n\n2.4.4 Scenariul III\nSugestia noastră personală cu cote de 16 şi 21 %. Se strâng 43.3 miliarde RON. Acest lucru înseamnă mai mult cu 15.3 miliarde de RON. Îl vom rotunji la 15 de miliarde RON.\n\n\n2.4.5 Scenariul IV\nScenariul slovac modificat, cu trepte de 19 şi 25 %. Se strâng 58.4 miliarde RON. Acest lucru înseamnă 21 miliarde de RON. Îl vom rotunji la 20 de miliarde RON."
  },
  {
    "objectID": "ratele_impozitarii.html#concluzii",
    "href": "ratele_impozitarii.html#concluzii",
    "title": "2  Analiza ratelor impozitării",
    "section": "2.5 Concluzii",
    "text": "2.5 Concluzii\nCreşterea impozitului pe venit reprezintă cea mai importantă componentă din pachetul de sugestii pe care le facem în acest raport. Vom ilustra rezultatele de până acum într-un tabel. Vom compara sumele cu cerinţele salariale ale profesorilor, cu impact calculat de autorităţi de circa 8 miliarde RON (creştere de 25 % şi aducerea salariilor debutanţilor la nivelul salariului mediu pe economie).\n\n\nArată codul\ntibble(\"Scenariu\"=c(\"Scenariul I: cote 10%, 16%\", \n                    \"Scenariul II: cote 10%, 19%\", \n                    \"Scenariul III: cote 10%, 16%, 21%\",\n                    \"Scenariul IV: cote 10%, 19%, 25%\"),\n       \"Suma\"=c(5, 7, 15, 20),\n       \"Buget\" = 100*c(5, 7, 15, 20)/379.6,\n       \"PIB\" = 100*c(5, 7, 15, 20)/1182,\n       \"Cerinţele profesorilor\"=c(5,7,15,20)/8) %>%\n  gt::gt() %>% gtExtras::gt_theme_538() %>%\n  gt::tab_spanner(label=\"Procentul (%) din\", columns=c(Buget, PIB)) %>%\n  gt::fmt_percent(columns=c(Buget, PIB), decimals = 2, scale_values = F) %>%\n  gt::fmt_number(columns=5) %>%\n  tab_header(title=\"Cele patru scenarii de impozitare\", \n             subtitle=\"Sursa: calcule proprii pe datele World Inequality Database\") %>%\n  tab_footnote(footnote = \"Pragurile sunt de 600, 2200 EURO brut (ultimii 30 %, top 8 %)\",\n               locations=cells_title()) %>%\n  tab_footnote(footnote=\"De câte ori depăşesc sumele colectate cerinţele profesorilor de majorare salarială cu 25 %\", \n               locations=cells_column_labels(columns=`Cerinţele profesorilor`)) %>% \n  tab_footnote(footnote=\"Miliarde RON\", \n               locations = cells_column_labels(columns=2)) %>%\n  gt::opt_row_striping() %>% \n  gt::tab_style(style=cell_fill(color=culori[1]), \n                locations=cells_column_labels()) %>% \n  tab_style(style=cell_fill(color=culori[1]), \n            locations=cells_column_spanners()) %>%\n  tab_style(style=cell_text(color='white'), \n            locations=cells_column_labels()) %>%\n  tab_style(style=cell_text(color='white'),\n            locations=cells_column_spanners()) %>%\n  gt::opt_vertical_padding(scale=1.2) %>%\n  tab_style(style=cell_borders(sides = \"bottom\", color=\"black\", \n                               weight = px(2)), \n            locations=cells_body(rows = 4)) %>%\n  gt::opt_table_font(font='Frutiger') %>%\n  tab_style(cell_text(font=\"Frutiger Bold\"), cells_title(groups='title'))\n\n\n\n\n\n\n  \n    \n      Cele patru scenarii de impozitare1\n    \n    \n      Sursa: calcule proprii pe datele World Inequality Database1\n    \n    \n      Scenariu\n      Suma2\n      \n        Procentul (%) din\n      \n      Cerinţele profesorilor3\n    \n    \n      Buget\n      PIB\n    \n  \n  \n    Scenariul I: cote 10%, 16%\n5\n1.32%\n0.42%\n0.62\n    Scenariul II: cote 10%, 19%\n7\n1.84%\n0.59%\n0.88\n    Scenariul III: cote 10%, 16%, 21%\n15\n3.95%\n1.27%\n1.88\n    Scenariul IV: cote 10%, 19%, 25%\n20\n5.27%\n1.69%\n2.50\n  \n  \n  \n    \n      1 Pragurile sunt de 600, 2200 EURO brut (ultimii 30 %, top 8 %)\n    \n    \n      2 Miliarde RON\n    \n    \n      3 De câte ori depăşesc sumele colectate cerinţele profesorilor de majorare salarială cu 25 %"
  },
  {
    "objectID": "distributional.html",
    "href": "distributional.html",
    "title": "3  Aspecte distributive ale taxării",
    "section": "",
    "text": "Arată codul\nlibrary(tidyverse)\nlibrary(gt)\n\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#000000\", \"#0865a4\", \"#a48408\")\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\ntari <- read_delim(here::here(\"database\", \"WID\", \"WID_countries.csv\"), \n                  delim=\";\") %>% drop_na() %>% filter(region==\"Europe\") %>%\n        inner_join(read_csv(here::here(\"database\", \"dictionar_tari.csv\")) %>%\n                   rename(shortname=geo)) %>% select(-shortname) %>% \n        rename(geo=tari) %>% select(-region) %>% rename(region=region2)\n\nmetadata <- read_delim(here::here(\"database\", \"WID\", \n                                  \"WID_metadata_RO.csv\")) %>%\n            select(variable, shortname, shorttype)\n\ndf <- here::here(\"database\", \"WID\", \n                 paste0(\"WID_data_\", tari$alpha2, \".csv\")) %>%\n      map_dfr(., ~ read_delim(.x, delim=';') %>% \n               rename(alpha2=country) %>% \n               inner_join(tari %>% select(-titlename)) %>% \n               mutate(age=as.character(age)) %>% \n               rename(country=alpha2)) %>%\n               filter(year>1989)\n\n\nProcentul din venitul naţional înaintea taxelor care revine diferitelor categorii de distribuţie:\n\n\nArată codul\ndf %>% filter(grepl(\"sdiincj992|sptincj992\", variable)) %>% \n  spread(variable, value) %>% \n  filter(percentile%in%c(\"p0p20\", \"p0p50\", \"p90p100\", \"p99p100\")) %>% \n  ggplot(aes(x=year, y=sptincj992, group=geo)) + \n  geom_line(aes(colour=geo), size=1) + \n  facet_wrap(~percentile, ncol=2, scales='free') + \n  gghighlight::gghighlight(geo%in%c(\"Romania\", \"Bulgaria\", \n                                    \"Polonia\", \"Ungaria\"),\n                           calculate_per_facet = T, use_direct_label = F) +\n  theme(legend.position = \"top\") + \n  labs(title=\"Distribuţia venitului naţional înaintea taxelor\", \n       subtitle=\"După distribuţie\", colour='Ţară', y=NULL, x=\"Anul\", \n       caption=\"Sursa: World Inequality Database\") +\n  scale_y_continuous(labels=scales::percent_format()) +\n  scale_color_manual(values=culori[c(1, 3, 5, 8)])\n\n\n\n\n\nŞi pentru venitul naţional după taxe:\n\n\nArată codul\ndf %>% filter(grepl(\"sdiincj992|sptincj992\", variable)) %>% \n  spread(variable, value) %>% filter(geo!=\"Cipru\") %>%\n  filter(percentile%in%c(\"p0p10\", \"p0p50\", \"p90p100\", \"p99p100\")) %>% \n  ggplot(aes(x=year, y=sdiincj992, group=geo)) + \n  geom_line(aes(colour=geo), size=1) + \n  facet_wrap(~percentile, ncol=2, scales='free') + \n  gghighlight::gghighlight(geo%in%c(\"Romania\", \"Bulgaria\", \n                                    \"Polonia\", \"Ungaria\"),\n                           calculate_per_facet = T, use_direct_label = F) +\n  theme(legend.position = \"top\") + \n  labs(title=\"Distribuţia veniturilor naţionale după taxare\", \n       subtitle=\"După distribuţie\", colour='Ţară', y=NULL, x=\"Anul\", \n       caption=\"Sursa: World Inequality Database\") +\n  scale_y_continuous(labels=scales::percent_format()) +\n  scale_color_manual(values=culori[c(1, 3, 5, 8)])\n\n\n\n\n\nRomânia, dar şi alte ţări din Europa de Est stau destul de rău la capitolul inegalitate, fiind în top atât înainte cât şi după taxe. În cazul României venitul revenit celor mai bogaţi 1 % din societate e totuşi mai scăzut după taxare, dar la categoria top 10 % situaţia e tot acută comparativ cu restul ţărilor europene.\nVom calcula raportul dintre procentele de venit naţional care revin celor top 10 % şi ultimilor 50 % atât pentru venitul pre-taxe cât şi pentru venitul post-taxe. Cele două rapoarte vor fi pe axele x, respectiv y în graficul următor. Urmărim aceşti doi indicatori pentru media perioadei 2012-2021 (ultimii zece ani).\n\n\nArată codul\nratios <- df %>% \n    filter(grepl(\"adiincj992|aptincj992\", variable)) %>% \n    filter(year>1989, age==\"992\") %>% select(-age, -pop) %>%\n    spread(variable, value) %>% \n    filter(percentile%in%c(\"p0p50\", \"p90p100\")) %>% \n    pivot_wider(names_from=percentile, \n                values_from = c(adiincj992, aptincj992)) %>% \n    mutate(ratio_pre = aptincj992_p90p100/aptincj992_p0p50, \n           ratio_post = adiincj992_p90p100/adiincj992_p0p50) %>% \n    filter(year>2011) %>%\n    group_by(geo, region) %>% \n    summarise(ratio_pre = mean(ratio_pre), \n              ratio_post=mean(ratio_post)) %>% ungroup() \n\nratios %>% filter(!geo%in%\"Lituania\") %>% \n  ggplot(aes(x=ratio_pre, y=ratio_post)) + \n  geom_point(colour=culori[1]) + \n  ggrepel::geom_text_repel(aes(label=geo), size=3) + \n  labs(title=\"Raportul veniturilor pentru top 10 % vs ultimii 50 %\", \n       subtitle=\"Media 2012-2021\", x=\"Pre-taxe\", y=\"Post-taxe\", \n       caption=\"Sursa: calcule pe datele din World Inequality Database\") + \n  geom_smooth(method='lm', linetype=2, fill=culori[1], colour=culori[2])\n\n\n\n\n\nObservăm că România are cel mai mare raport atât pre cât şi post taxare. Acest lucru sugerează că sistemul fiscal nu redistribuie suficient către cei din decilele inferioare ale distribuţiei. Acest lucru se întâmplă în ţara cu cea mai mare inegalitate din Europa dacă excludem Serbia (nu apare în imagine). Merită să calculăm şi procentele cu care sistemul fiscal reduce inegalitatea pre-taxe pentru fiecare ţară, media pe ultimii zece ani. Vom folosi formula:\n\\[\nR = -\\frac{  Inc_{top10/bottom50}^{post-taxe} - Inc_{top10/bottom50}^{pre-taxe} }{ Inc_{top10/bottom50}^{pre-taxe}   }\n\\]\n\n\nArată codul\n#| fig-width: 7\n#| fig-height: 5\n#| fig-dpi: 200\n\ndf %>% \n    filter(grepl(\"adiincj992|aptincj992\", variable)) %>% \n    filter(year > 2011, age==\"992\") %>% select(-age, -pop) %>%\n    spread(variable, value) %>% \n    group_by(country, percentile, region, geo) %>%\n    summarise(across(adiincj992:aptincj992, mean)) %>%\n    ungroup() %>%\n    filter(percentile%in%c(\"p0p50\", \"p90p100\")) %>% \n    pivot_wider(names_from=percentile, \n                values_from = c(adiincj992, aptincj992)) %>% \n    mutate(ratio_pre = aptincj992_p90p100/aptincj992_p0p50, \n           ratio_post = adiincj992_p90p100/adiincj992_p0p50) %>% \n    mutate(delta = 100*(ratio_pre - ratio_post)/ratio_pre) %>% \n    select(geo, region, delta) %>% \n    filter(!grepl(\"Cipru|Lituania\",geo)) %>% \n    mutate(geo=fct_reorder(geo, delta)) %>% \n    ggplot(aes(x=geo, y=delta)) + geom_col(fill=culori[1]) + \n    theme(axis.text.x = element_text(angle=90)) +\n    labs(title=\"Reducerea inegalităţii pre-taxe de sistemul fiscal\", \n         x=\"Ţară\", subtitle=\"Media 2012 - 2021\", y=\"Procent (%)\", colour=\"Ţară\",\n         caption=\"Sursa: calcule pe datele din World Inequality Database\") +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) \n\n\n\n\n\nObservăm că România se află printre ţările cu cele mai mici raporturi ale reducerii inegalităţii pre-taxe prin taxare. Combinaţia de inegalitate mare pre-taxare combinată cu redistribuţia scăzută duce la situaţia actuală. Procentele mici pentru Spania şi Italia nu trebuie să ne mire, întrucât aceste state cheltuiesc mult cu pensiile (populaţii îmbătrânite), lucru care uniformizează inegalitatea pre-taxe într-o oarecare măsură (inegalitatea pre-taxe este calculată conform autorilor ca venitul naţional revenit factorilor de producţie minus contribuţiile pentru pensii şi asigurări sociale plus distribuţiile pentru ele). Ele au oricum o inegalitate pre-taxe mai redusă în primul rând."
  },
  {
    "objectID": "Impozit_profit.html",
    "href": "Impozit_profit.html",
    "title": "4  Impozitul pe profit",
    "section": "",
    "text": "Au fost descărcate situaţiile financiare de pe data.gov.ro pentru ultimul an la care datele au fost accesibile (anume 2021). S-au descărcat doar firmele care au depus bilanţuri de tip BL_BS_SL, UU (simplificat) şi IR. S-au luat datele pe anul 2021 cu privire la impozitul pe profit din execuţia bugetară de pe siteul MF. Au fost încasate in 2021 20.045 miliarde RON ca impozit pe profit. Vom vedea câţi bani “încasăm” teoretic aplicând cotele cunoscute de impozitare pe firmele din setul nostru de date."
  },
  {
    "objectID": "Impozit_profit.html#analize-exploratorii",
    "href": "Impozit_profit.html#analize-exploratorii",
    "title": "4  Impozitul pe profit",
    "section": "4.2 Analize exploratorii",
    "text": "4.2 Analize exploratorii\n\n\nArată codul\nlibrary(tidyverse)\nlibrary(gt)\nlibrary(TEMPO)\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#000000\", \"#0865a4\", \"#a48408\")\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\nfirme <- read_csv(here::here(\"database\", \"bl_bs_sl+ir+uu.csv\")) %>%\n         select(cui, caen, cifra_afaceri=cifra_de_afaceri_neta, \n                profit_net, profit_brut, pierdere_neta, \n                salariati=numar_mediu_de_salariati, \n                categorie) %>% mutate(caen=as.character(caen))\n\n\nPentru toate firmele din setul de date, suma calculată ca diferenţa dintre profitul brut şi cel net (impozitul plătit) este de 19.318 miliarde RON. Similar cu impozitul colectat.\nPentru firmele cu bilanţ BL_BS_SL suma este de 14.619 miliarde RON. Pentru firmele cu bilanţ de tip UU suma este de 3.032 miliarde RON. Şi 1.666 miliarde de RON pentru firmele cu bilanţ de tip IR.\nSuma plătită de firmele cu bilanţ UU este a 5-a parte din cea cu bilanţ de tip BL_BS deşi firmele cu bilanţ UU sunt de 10 ori mai multe. În 2023, firmele fără angajaţi sunt obligate să plătească 16 % din profit indiferent de mărime.\nAvem un număr de circa 781578 companii nefinanciare în economie pentru anul 2021 cu o profitabilitate agregată din cifra de afaceri de circa 9.65 % (ignorând pierderile) sau 7.74 % (înglobând pierderile). Circa 153.703 firme nu au cifra de afaceri în setul de date. Nu este oare declarată la ANAF sau datele sunt parţiale, este greu de aflat. Site-ul listafirme.ro le dă ca fiind 0 pe aceste valori care lipsesc din setul de date. Vom calcula acum rata de taxare efectivă prin următoarea formulă:\n\\[\nImpozit_{efectiv} = 100*\\frac{Profit_{brut} - Profit_{net}}{Profit_{brut}}\n\\]\n\n\nArată codul\nfirme %>% mutate(impozit=profit_brut-profit_net) %>% \n  group_by(categorie) %>% \n  summarise(ratio = 100*sum(profit_brut-profit_net, na.rm=TRUE)/sum(profit_brut, na.rm=TRUE)) %>% \n  mutate(categorie = gsub(\"_an2021.txt|web_\", \"\", categorie)) %>% \n  mutate(categorie = gsub(\"bl_bs_sl\", \"Plătitoare de CIT\", categorie) %>%\n                     gsub(\"ir\", \"Plătitoare de CIT (bilanţ IFRS)\", .) %>%\n                     gsub(\"uu\", \"Microîntreprinderi\", .)) %>%\n  gt::gt() %>% gt::fmt_percent(columns=ratio, decimals=2, scale_values = FALSE) %>% \n  gt::tab_header(title=\"Rata de taxare efectivă în 2021\", \n                 subtitle=\"Sursa: situaţiile financiare de pe data.gov.ro\") %>%\n  gtExtras::gt_theme_538() %>%\n  gt::tab_style(style=cell_fill(color=culori[1]), locations = cells_column_labels()) %>%\n  gt::tab_style(style=gt::cell_text(color=\"white\"), locations=cells_column_labels()) %>%\n  gt::opt_table_font(font=\"Frutiger\") \n\n\n\n\n\n\n  \n    \n      Rata de taxare efectivă în 2021\n    \n    \n      Sursa: situaţiile financiare de pe data.gov.ro\n    \n    \n      categorie\n      ratio\n    \n  \n  \n    Plătitoare de CIT\n12.18%\n    Plătitoare de CIT (bilanţ IFRS)\n11.17%\n    Microîntreprinderi\n4.57%\n  \n  \n  \n\n\n\n\nRegimul de impozitare pe cifra de afaceri este cu siguranţă avantajos per total.\nCare metodă de taxare aduce mai mulţi bani la buget ? Cota pe profit sau cea pe cifra de afaceri ? Din păcate rezultatele sunt dezamăgitoare, cota pe profit aducând doar marginal mai mulţi bani decât cea pe cifra de afaceri. Am simulat 100 de valori uniform distribuite pentru pragul nostru de taxare (în 2021 1 milion de EURO, din 2023 doar 500.000 de EURO) pentru a vedea dacă există vreun optim. Ele încep cu 0 (toate firmele plătesc doar impozit pe profit) şi merg până la 1 milion de EURO. Suma care ar fi încasată presupunând că schimbările afectează doar bilanţurile de tip UU e afişată în graficul următor.\n\n\nArată codul\nprofit <- numeric(100)\npraguri <- seq(0, 4870000, length.out=100)\nfor(i in 1:100){\nprofit[i] <- firme %>% filter(grepl(\"uu\", categorie)) %>% \n  mutate(profit = if_else(cifra_afaceri>praguri[i], \n                          0.16*profit_brut, 0.01*cifra_afaceri)) %>% \n  pull(profit) %>% sum(na.rm=TRUE)\n}\n\ntibble(\"praguri\"=praguri, \"profit\"=profit) %>% \n  mutate(profit=profit/1000000000) %>% \n  ggplot(aes(x=praguri, y=profit)) + geom_line() + geom_point() +\n  labs(title = \"Impozit pe profit colectat de la microîntreprinderi\", \n       subtitle=\"Miliarde RON\", x=\"Prag (RON)\", y=\"Impozit colectat\", \n       caption=\"Sursa: calcule proprii pe bilanţurile anului 2021\") +\n  scale_x_continuous(labels = scales::number_format(big.mark=',')) +\n  theme(plot.title = element_text(size=12))\n\n\n\n\n\nS-ar obţine cu 202 % mai mulţi bani ! Circa 6.9 miliarde RON dacă toate ar plăti impozit pe profit de 16 % ! Dacă pragul ar coborî din nou la 500.000 EURO (aproximativ 2.5 milioane RON) s-ar obţine circa 4.77 miliarde RON de la această categorie de firme în loc de 3 miliarde acum. Un surplus important. Pentru un prag de 250.000 EURO (aproximativ 1.25 milioane RON) s-ar obţine circa 5.95 miliarde. Cu circa 2.9 miliarde RON în plus. Vom asuma 2.5 miliarde RON ca să ne luăm o marjă de eroare. Aceste estimate trebuie privite cu suspiciune din cauza faptului că firmele nu iau decizii statice, ci sunt influenţate de oportunităţile existente sau create."
  },
  {
    "objectID": "Impozit_profit.html#taxe-sectoriale",
    "href": "Impozit_profit.html#taxe-sectoriale",
    "title": "4  Impozitul pe profit",
    "section": "4.3 Taxe sectoriale",
    "text": "4.3 Taxe sectoriale\nSe pune problema unor taxe sectoriale asemenea taxei ungureşti pe publicitate (CAEN 7311), retail (CAEN 46 şi 47) şi telecomunicaţii (CAEN 61).\n\n\nArată codul\nincasari_retail <- firme %>% filter(grepl(\"^4[6-7]\", caen)) %>% \n                   mutate(profit = if_else(cifra_afaceri>1350000000, \n                                0.027*(cifra_afaceri-1350000000), 0)) %>%\n                   pull(profit) %>% sum(na.rm=TRUE)\n\n\nSunt în total 198532firme în situaţia aceasta din totalul de 781578 analizate. (circa 25.4 %) pe anul 2021. Cât am obţine ca impozit folosind cotele din Ungaria pt retail (0 % până la 270.000.000 EURO şi 2.7 % pe cifra de afaceri ce depăşeşte 270.000.000 EURO) ? Circa 4.8749355 miliarde RON! Ar afecta circa 47 de firme din comerţ.\nPentru simulări cu o singură cotă progresivă de impozitare accesează aplicaţia online creată special în acest scop. În tabelul aplicaţiei, la variabila procent avem procentul de firme din decila respectivă a cifrei de afaceri care şi-ar putea onora noul impozit pe profit din profitul net obţinut."
  },
  {
    "objectID": "Impozit_profit.html#simulări-de-taxe-sectoriale",
    "href": "Impozit_profit.html#simulări-de-taxe-sectoriale",
    "title": "4  Impozitul pe profit",
    "section": "4.4 Simulări de taxe sectoriale",
    "text": "4.4 Simulări de taxe sectoriale\nSă investigăm acum efectul unor potenţiale taxe pe diferite sectoare, pentru început energie, retail, tranzacţii imobiliare şi jocuri de noroc.\n\n4.4.1 Energie fosilă\nImpactul taxelor sectoriale pe sectorul energiei, considerând scenariul implementat în Spania (1.2 % pe cifra de afaceri netă pentru companiile din energie cu cifra de afaceri de peste 1 miliard de EURO) şi unul propus de noi, aceeaşi cotă dar la un prag de 1 miliard de RON. Ca de obicei, folosim ultimele date existente în spaţiul public, cele din 2021 de pe data.gov.ro. Vom folosi firmele cu bilanţuri de tip BL BS SL, UU şi IR. Ele sunt grosul companiilor nefinanciare din economia românească.\nCodurile CAEN pentru extracţia de petrol şi cărbune sunt 05 şi 06. Furnizarea şi producţia de energie electrică e acoperită de codurile CAEN 351 (producţia, transportul, distribuţia energiei) şi 352 (idem pentru combustibili).\n\n\nArată codul\nfosili <- c(\"Producția, transportul si distributia energiei electrice\"=\"351\",\n            \"Producția gazelor; distributia combustibililor gazosi prin conducte\"=\"352\", \"Extracția cărbunelui superior și inferior\"=\"05\", \n            \"Extracția petrolului brut și a gazelor naturale\"=\"06\")\n\n\n\n\nArată codul\ncalculeaza <- function(CAEN, procent, prag, tara=\"Spania\"){\n  if(tara==\"Spania\"){\nfirme %>% filter(grepl(CAEN, caen)) %>% \n                 mutate(impozit = if_else(cifra_afaceri > prag, \n                                          procent*(cifra_afaceri-prag),\n                                          0)) %>% \n    pull(impozit) %>% sum(.,na.rm=TRUE) %>% `/`(., 1000000)\n  } else {\n    firme %>% filter(grepl(CAEN, caen)) %>% \n      mutate(impozit = if_else(cifra_afaceri > prag, 0.6*profit_net, 0)) %>%\n      pull(impozit) %>% sum(., na.rm=TRUE) %>% `/`(., 1000000)\n  }\n}\n\n\n\n\nArată codul\nvalori_fosili_sp <- c(\"351.\", \"352.\", \"^5..$\", \"^6..$\") %>% \n  map_dbl(., ~calculeaza(CAEN=.x, procent=0.012, \n                         prag=5000000000, tara=\"Spania\"))\nnames(valori_fosili_sp) <- names(fosili)\n\nvalori_fosili_ro <- c(\"351.\", \"352.\", \"^5..$\", \"^6..$\") %>% \n  map_dbl(., ~calculeaza(CAEN=.x, procent=0.012, \n                         prag=1000000000, tara=\"Spania\"))\nnames(valori_fosili_ro) <- names(fosili)\n  \ndf_fosili <- enframe(valori_fosili_sp) %>% \n      mutate(CAEN = fosili) %>% relocate(CAEN) %>% \n      rename(`Scenariul spaniol`=value) %>%\n      inner_join(enframe(valori_fosili_ro)) %>%\n      rename(`Scenariul propus`=value, Descriere=name)\n\ngt(df_fosili) %>% \n  tab_header(title = \"Impozit colectat teoretic (milioane RON)\", \n             subtitle=\"Scenariul spaniol şi cel propus\") %>%\n  gt::fmt_number(columns = 3:4, decimals = 2) %>% \n  gt::grand_summary_rows(3:4, fns = list(Total=~sum(.))) %>%\n  gtExtras::gt_theme_538() %>%\n  gt::opt_table_font(font='Frutiger Light') %>%\n  gt::tab_style(cell_fill(color=culori[1]), cells_column_labels()) \n\n\n\n\n\n\n  \n    \n      Impozit colectat teoretic (milioane RON)\n    \n    \n      Scenariul spaniol şi cel propus\n    \n    \n      \n      CAEN\n      Descriere\n      Scenariul spaniol\n      Scenariul propus\n    \n  \n  \n    \n351\nProducția, transportul si distributia energiei electrice\n27.35\n346.21\n    \n352\nProducția gazelor; distributia combustibililor gazosi prin conducte\n55.15\n181.63\n    \n05\nExtracția cărbunelui superior și inferior\n0.00\n0.00\n    \n06\nExtracția petrolului brut și a gazelor naturale\n231.74\n327.74\n    Total\n—\n—\n314.2364\n855.5678\n  \n  \n  \n\n\n\n\nSunt în total 2290 de firme din sectorul energiei, dar doar 22 au cifra de afaceri peste 1 miliard de RON (scenariul nostru). Şi 7 din ele au declarat pierderi în 2021. Săraci, dar cinstiţi…\n\n\nArată codul\nsume_energie <- enframe(valori_fosili_ro) %>% mutate(caen = fosili) %>% \n  select(-name) %>% relocate(caen) %>% rename(valoare=value) %>% \n  mutate(valoare=valoare/1000)\n\n\n\n\n4.4.2 Jocuri de noroc\nJocurile de noroc au cod CAEN 92. 14 firme au cifra de afaceri peste 100 de milioane RON in 2021 şi 150 au peste 10 milioane. Totalul firmelor este 679. Vom implementa mai multe praguri cu o rată de 1.2 %.\n\n\nArată codul\nmap_dbl(c(0, 1000000, 10000000, 100000000),\n        ~calculeaza(CAEN=\"92..\", procent=0.012, prag=.x)) %>%\n  enframe(.) %>% select(-name) %>% \n  mutate(name=c(\"Toate\", \"1 milion\", \"10 milioane\", \"100 milioane\")) %>%\n  relocate(name) %>% rename(Prag=name, Valoare=value) %>%\n  gt() %>% \n  tab_header(\"Impozit colectat de la jocurile de noroc\", subtitle=\"Milioane RON\") %>% \n  gt::fmt_number(columns=2, decimals=2) %>%\n  gtExtras::gt_theme_538() %>%\n  gt::opt_table_font(font='Frutiger Light') %>%\n  gt::tab_style(cell_fill(color=culori[1]), cells_column_labels()) \n\n\n\n\n\n\n  \n    \n      Impozit colectat de la jocurile de noroc\n    \n    \n      Milioane RON\n    \n    \n      Prag\n      Valoare\n    \n  \n  \n    Toate\n106.79\n    1 milion\n102.93\n    10 milioane\n80.27\n    100 milioane\n28.31\n  \n  \n  \n\n\n\n\nVom opta pentru pragul 0, adică toate vor fi impozitate în această manieră.\n\n\nArată codul\nsume_jocuri <- map_dfr(c(\"92..\"), \n                       ~ calculeaza(CAEN=.x, procent=0.012, prag=0) %>% \n      enframe() %>% select(-name) %>%\n      mutate(caen = .x) %>% relocate(caen) %>% \n      rename(valoare=value) %>% mutate(valoare=valoare/1000)) \n\n\n\n\n4.4.3 Tranzacţii imobiliare\nNu cred că merită efortul, se adună 170 de milioane de RON la un prag foarte jos de 1 milion de RON.\n\n\n4.4.4 Retail\nCodurile CAEN 46 şi 47 se ocupă de tot ce înseamnă comerţ. Să vedem câţi bani se adună la o rată de 1.2 % pe cifra de afaceri netă.\n\n\nArată codul\nseq(0, 1000000000, length.out=100) %>%\n  map_dbl(. ,~calculeaza(CAEN=\"4[6-7]..\", procent=0.012, prag=.x)) %>%\n  enframe() %>% select(-name) %>% \n  mutate(praguri = seq(0, 1000000000, length.out=100)) %>%\n  ggplot(aes(x=praguri, y=value)) + geom_point() + geom_line() +\n  labs(title=\"Impozit colectat teoretic din retail\", \n       x=\"Prag CA\", y=\"milioane RON\", \n       caption=\"Sursa: Calcule proprii pe bilanţurile firmelor, 2021\")\n\n\n\n\n\n8 miliarde de RON s-ar aduce la buget dacă ar fi aplicat tuturor firmelor din comerţ. Apoi suma scade vertiginos. La un prag de 100 milioane RON s-ar aduna aproximativ 4 miliarde la buget. Ar fi afectate circa 709 firme din 186.301 la acest prag. Este pragul pe care-l vom selecta.\n\n\nArată codul\nsume_retail <- map_dfr(c(\"46..\", \"47..\"), \n                       ~ calculeaza(CAEN=.x, procent=0.012, prag=100000000) %>% \n      enframe() %>% select(-name) %>%\n      mutate(caen = .x) %>% relocate(caen) %>% \n      rename(valoare=value) %>% mutate(valoare=valoare/1000)) \n\n\n\n\n4.4.5 IT\nÎn industria IT pentru codurile CAEN 5821, 5829, 6201, 6202, 6209 există o scutire totală de la plata impozitului pe venit. Asumând ca toţi salariaţii din aceste firme beneficiază de scutire, obţinem:\n\n\nArată codul\nnumar_it <- firme %>% \n  filter(caen%in%c(5821, 5829, 6201, 6202, 6209)) %>% \n  group_by(caen=substr(caen, 1, 2)) %>%\n  summarise(salariati=sum(salariati, na.rm=TRUE)) \n\nmedii_it <- read_csv(here::here(\"database\", \"FOM107D.csv\")) %>% \n  set_names(c(\"caen\", \"luni\",\"um\", \"valoare\")) %>% \n  filter(grepl(\"58|62\", caen)) %>% filter(grepl(\"2021\",luni)) %>% \n  select(-um) %>% group_by(caen) %>% summarise(valoare=mean(valoare)) %>%\n  ungroup() %>%\n  mutate(caen = str_extract(caen, \"^[0-9]{2}\"))\n\nsume_it <- numar_it %>% inner_join(medii_it) %>% \n  mutate(sume = 12*salariati*valoare/10000000000) \n\ngt::gt(sume_it) %>%\n  gtExtras::gt_theme_538() %>%\n  gt::opt_table_font(font='Frutiger') %>%\n  gt::tab_style(cell_fill(color=culori[1]), cells_column_labels()) %>%\n  gt::fmt_number(columns=3:4)\n\n\n\n\n\n\n  \n    \n    \n      caen\n      salariati\n      valoare\n      sume\n    \n  \n  \n    58\n12197\n9,835.42\n0.14\n    62\n113896\n13,542.08\n1.85\n  \n  \n  \n\n\n\n\nConform MF, doar 97000 de IT în 2021 beneficiau de scutire, ducând suma scutită de la buget undeva la 900 milioane RON.\n\n\n4.4.6 Construcţii\nAici avem codurile CAEN 41, 42, 43 şi 2312, 2331, 2332, 2361, 2362, 2363, 2364, 2369, 2370,\n2223, 1623, 2512, 2511, 0811, 0812, 2351, 2352, 2399, 711 scutite de impozitul pe venit, contribuţia la sănătate şi plătesc doar 21.25 % din venitul brut ca contribuţie la asigurările sociale.\n\n\nArată codul\ncoduri <- c(2312, 2331, 2332, 2361, 2362, 2363, 2364, 2369, 2370, 2223, 1623, 2512, 2511, 2351, 2352, 2399) %>% as.character()\n\nnumar_constructii <- firme %>% mutate(caen=as.character(caen)) %>% \n  filter(caen%in%coduri | grepl(\"^41|^42|^43|^711|^0811|^0812\", caen)) %>% \n  group_by(caen = substr(caen, 1, 2) %>% gsub(\"41|42|43\", \"F\", .)) %>%\n  summarise(salariati=sum(salariati, na.rm=TRUE)) %>% ungroup() \n\nmedia_constructii <- read_csv(here::here('database', \"FOM107D.csv\")) %>% \n  set_names(c(\"caen\", \"luni\", \"um\", \"valoare\")) %>% \n  filter(grepl(\"2021\", luni)) %>% \n  filter(grepl(\"^23|^08|^22|^16|^25|^F\\\\s\", caen)) %>% \n  group_by(caen) %>% summarise(valoare=mean(valoare)) %>% \n  ungroup() %>% mutate(caen=str_extract(caen, \"[0-9]+|F\"))\n\nsume_constructii <- inner_join(numar_constructii, media_constructii) %>%\n  mutate(sume = 2*1.2*salariati*valoare/1000000000)\n\n\n\n\n4.4.7 Industria alimentară şi agricultura\nConform legii nr. 135/2022 angajaţii la firmele cu coduri CAEN 01 şi 10 se bucură de aceleaşi scutiri ca şi cei din sectorul construcţiilor.\n\n\nArată codul\nnumar_alimentar <- firme %>% filter(cui!=7740456) %>% \n  mutate(caen=as.character(caen)) %>% \n  filter(grepl(\"^1.[0-6]$|^10\", caen)) %>% \n  group_by(caen=if_else(substr(caen, 1, 2) == \"10\", substr(caen, 1, 2), \"01\")) %>%\n  summarise(salariati=sum(salariati, na.rm=TRUE)) %>% ungroup() \n\nmedia_alimentar <- read_csv(here::here('database', \"FOM107D.csv\")) %>% \n  set_names(c(\"caen\", \"luni\", \"um\", \"valoare\")) %>% \n  filter(grepl(\"2021\", luni)) %>% \n  filter(grepl(\"^01|^10\", caen)) %>% \n  group_by(caen = if_else(substr(caen, 1, 2)==\"10\", substr(caen, 1, 2), \"01\")) %>%\n  summarise(valoare=mean(valoare)) %>% \n  ungroup() %>% mutate(caen=str_extract(caen, \"[0-9]+\"))\n\nsume_alimentar <- inner_join(numar_alimentar, media_alimentar) %>%\n  mutate(sume = 2*1.2*salariati*valoare/1000000000)\n\n\n\n\n4.4.8 Însumat\n\n\nArată codul\ninsumat <- sume_alimentar %>% mutate(sector=\"Alimentar & Agricultura\") %>% \n                   select(sector, caen, valoare=sume) %>%\n  bind_rows(sume_constructii %>% mutate(sector=\"Construcţii\") %>% \n            select(sector, caen, valoare=sume),\n            sume_energie %>% mutate(sector=\"Energie\"),\n            sume_it %>% mutate(sector=\"IT\") %>% select(sector, caen, valoare=sume), \n            sume_jocuri %>% mutate(sector=\"Jocuri de noroc\"),\n            sume_retail %>% mutate(sector=\"Retail\"))\n\ninsumat %>% rename(CAEN=caen, VALOARE = valoare) %>% \n  mutate(sector=str_to_upper(sector)) %>%\n  gt::gt(groupname_col = \"sector\") %>% \n  gt::fmt_number(columns=3, decimals = 2) %>% \n  tab_header(title=\"Impact taxe sectoriale şi eliminări scutiri (miliarde RON)\", \n             subtitle=\"Calcule proprii pe bilanţurile anului 2021\") %>%\n  gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)), \n                         fmt = ~fmt_number(., decimals = 2)) %>%\n  tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%\n  tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%\n  tab_style(style=cell_text(weight = \"bold\"), locations=cells_row_groups()) %>%\n  tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%\n  tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%\n  tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%\n  tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%\n  tab_style(style=cell_text(color=\"#fff\"), locations=cells_grand_summary()) %>%\n  gt::tab_options(container.width = \"70%\", table.layout = \"auto\", \n                  table.align = \"center\", \n                  table.additional_css = \"table.gt_table {border: 2px solid black;}\") %>%\n  gt::tab_footnote(footnote = \"Eliminare scutire actuală\", \n                   locations = cells_row_groups(groups=c(\"ALIMENTAR & AGRICULTURA\",\n                                                         \"CONSTRUCŢII\", \"IT\"))) %>%\n  gt::tab_footnote(footnote=\"1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON\", locations = cells_row_groups(groups=\"ENERGIE\")) %>%\n  gt::tab_footnote(footnote = \"1.2 % impozit pe cifra de afaceri pentru toate firmele\",\n                   locations=cells_row_groups(\"JOCURI DE NOROC\")) %>%\n  gt::tab_footnote(footnote=\"1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON\", locations=cells_row_groups(groups=\"RETAIL\")) %>% gtExtras::gt_theme_538() %>%\n  gt::opt_table_font(font=\"Frutiger\") %>%\n  tab_style(style=cell_text(font=\"Frutiger Bold\"), cells_title(groups=\"title\"))\n\n\n\n\n\n\n  \n    \n      Impact taxe sectoriale şi eliminări scutiri (miliarde RON)\n    \n    \n      Calcule proprii pe bilanţurile anului 2021\n    \n    \n      \n      CAEN\n      VALOARE\n    \n  \n  \n    \n      ALIMENTAR & AGRICULTURA1\n    \n    \n01\n0.69\n    \n10\n1.38\n    \n      CONSTRUCŢII1\n    \n    \n16\n0.07\n    \n22\n0.18\n    \n23\n0.41\n    \n25\n0.43\n    \nF\n4.37\n    \n      ENERGIE2\n    \n    \n351\n0.35\n    \n352\n0.18\n    \n05\n0.00\n    \n06\n0.33\n    \n      IT1\n    \n    \n58\n0.14\n    \n62\n1.85\n    \n      JOCURI DE NOROC3\n    \n    \n92..\n0.11\n    \n      RETAIL4\n    \n    \n46..\n2.10\n    \n47..\n2.08\n    TOTAL\n—\n14.67\n  \n  \n  \n    \n      1 Eliminare scutire actuală\n    \n    \n      2 1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON\n    \n    \n      3 1.2 % impozit pe cifra de afaceri pentru toate firmele\n    \n    \n      4 1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON"
  },
  {
    "objectID": "tipuri_taxe.html",
    "href": "tipuri_taxe.html",
    "title": "5  Analiza tipurilor de taxe",
    "section": "",
    "text": "Arată codul\nlibrary(tidyverse)\nlibrary(gt)\nlibrary(gtExtras)\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#000000\", \"#0865a4\", \"#a48408\")\n\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\n\ntaxari <- read_csv(here::here(\"database\", \"taxation_trends_eurostat.csv\"))\n\n\n\n\nArată codul\ngrafice <- function(df, var, numar=10){\n  \n  segmente <- df %>% filter(time%in%c(\"2009\", \"2021\")) %>% \n              select(geo, what, time, var) %>% \n              spread(what, var) %>% \n              pivot_wider(names_from = time, values_from = c(PIB, Total)) %>%\n              filter(!grepl(\"Luxemb|Irlanda|Malta|Cipru\", geo)) %>%\n              mutate(centru_x = 0.5*(Total_2009+Total_2021), \n                     centru_y=0.5*(PIB_2009+PIB_2021)) %>%\n              mutate(delta = sqrt((PIB_2021-PIB_2009)^2 + (Total_2021-Total_2009)^2)) %>%\n              mutate(directie = if_else(PIB_2021 < PIB_2009 & Total_2021 < Total_2009, \n                                        \"Scădere\", \"Creştere\")) %>%\n              arrange(desc(delta)) \n  \n  tari <- segmente %>% \n    arrange(desc(delta)) %>%\n    mutate(index = if_else(row_number()<numar | geo==\"Romania\", 1, 0)) %>%\n    filter(index==1) %>% select(-index) %>% pull(geo)\n  \n  segmente %>%\n    ggplot(aes(x=Total_2009, y=PIB_2009)) + \n    geom_point(colour='red3') + \n    geom_point(colour='red3', aes(x=Total_2021, y=PIB_2021)) +\n    geomtextpath::geom_textsegment(aes(x=Total_2009, xend=Total_2021, \n                                       y=PIB_2009, yend=PIB_2021, label=geo, size=delta,\n                                       colour=directie),\n                                   vjust=-0.3, arrow = arrow(length=unit(0.3, \"cm\")),\n                                   show.legend = c(\"size\"=FALSE)) + \n    scale_x_continuous(labels=scales::percent_format(scale=1)) +\n    scale_y_continuous(labels=scales::percent_format(scale=1)) +\n    scale_size_continuous(range=c(2, 4)) +\n    scale_colour_manual(values=c(culori[7], culori[4])) +\n    gghighlight::gghighlight(geo%in%tari) +\n    theme(legend.position = 'top')\n}\n\n\n\n\nArată codul\nrbiplot <- function(mat, p=1, clusters=4, k=15, scale=TRUE){\n  x <- mat[,apply(mat, MARGIN=2, FUN=mean)>p, drop=F] %>% colnames()\n  pca <- sparsepca::robspca(mat, scale=scale, verbose=FALSE)\n  procent <- pca$eigenvalues^2/sum(pca$eigenvalues^2)\n  procent <- paste(round(100*procent[1:2], 1), \"%\")\n  rot <- as_tibble(pca$loadings) %>% mutate(var=colnames(mat)) %>% filter(var%in%x)\n  model <- kmeans(pca$scores[,1:2], centers=clusters)$cluster\n  coords <- as_tibble(pca$scores, rownames=\"geo\") %>%\n    mutate(cluster = as.factor(model))\n  ggplot(coords, aes(x=V1, y=V2)) + \n    ggConvexHull::geom_convexhull(aes(x=V1, y=V2, group=cluster, fill=cluster), alpha=0.2) +\n    geom_point(colour='red3') + \n    ggrepel::geom_text_repel(aes(label=geo),nudge_y=0.3, max.overlaps = 10, size=3) +\n    geom_vline(xintercept = 0,linetype=2) +\n    geom_hline(yintercept=0, linetype=2) +\n    geom_segment(data=rot, aes(xend=k*V1, x=0, yend=k*V2, y=0), \n                 arrow = arrow(length = unit(0.25, \"cm\")), colour=culori[7]) +\n    ggrepel::geom_text_repel(data=rot, aes(label=var,x=k*V1, y=k*V2), \n                             alpha=0.9, colour=culori[7], size=3) +\n    labs(title=\"PCA - Biplot\", \n         subtitle=\"Componentele principale (robuste) ale cheltuielilor COFOG99 pe 2017-2021\", \n         caption=\"Sursa: calcule pe Eurostat, gov_10a_main\",\n         x=paste0(\"Dim1 (\", procent[1], \")\"), y=paste0(\"Dim2 (\", procent[2],\")\")) +\n    theme(axis.title = element_text(size=14)) +\n    scale_fill_manual(values = culori)\n  \n}\n\n\nVom ilustra situaţia cu toate aceste tipuri de taxe în grafice cu două axe - pe axa x fiind procentul din total taxe iar pe y procentul din PIB colectat. Să începem cu taxarea pe capital.\n\n\nArată codul\ngrafice(taxari, var = \"capital\", numar=10) + \n            labs(title=paste(\"Taxarea pe capital\", \"2009 vs 2021\"), \n                 subtitle=\"Sursa: Taxation trends in the European Union\", \n                 x=\"din Total\", y=\"din PIB\") \n\n\n\n\n\nTaxarea pe contribuţii\n\n\nArată codul\ngrafice(taxari, var = \"contributii\", numar=10) + \n            labs(title=paste(\"Taxarea pe contribuţii\", \"2009 vs 2021\"), \n                 subtitle=\"Sursa: Taxation trends in the European Union\", \n                 x=\"din Total\", y=\"din PIB\") +\n      scale_x_continuous(limits = c(25, 50), \n                         labels=scales::percent_format(scale=1)) +\n      scale_y_continuous(limits=c(6, 20), \n                         labels=scales::percent_format(scale=1))\n\n\n\n\n\nTaxarea pe muncă\n\n\nArată codul\ngrafice(taxari, var = \"munca\", numar=10) + \n            labs(title=paste(\"Taxarea pe muncă\", \"2009 vs 2021\"), \n                 subtitle=\"Sursa: Taxation trends in the European Union\", \n                 x=\"din Total\", y=\"din PIB\") \n\n\n\n\n\nTaxarea pe consum\n\n\nArată codul\ngrafice(taxari, var = \"consum\", numar=10) + \n            labs(title=paste(\"Taxarea pe consum\", \"2009 vs 2021\"), \n                 subtitle=\"Sursa: Taxation trends in the European Union\", \n                 x=\"din Total\", y=\"din PIB\") \n\n\n\n\n\nTaxele pe proprietate\n\n\nArată codul\ngrafice(taxari, var = \"proprietate\", numar=10) + \n            labs(title=paste(\"Taxarea pe proprietate\", \"2009 vs 2021\"), \n                 subtitle=\"Sursa: Taxation trends in the European Union\", \n                 x=\"din Total\", y=\"din PIB\") \n\n\n\n\n\nŞi multidimensional, o hartă a taxării în Europa. Vom folosi ca valori pentru diferitele tipuri de taxări media între 2018-2021 pentru o imagine mai robustă.\n\n\nArată codul\nmat <- taxari %>% filter(what==\"PIB\") %>% mutate(time=as.numeric(time)) %>%\n       filter(time>\"2017\") %>% group_by(geo) %>% \n       summarise(across(capital:proprietate, mean)) %>% \n       select(geo, capital:proprietate) %>% filter(geo!=\"Irlanda\") %>%\n       column_to_rownames(\"geo\") \n\nrbiplot(mat, p=0, clusters=3, k=5) +\n  labs(title=\"Componentele principale ale diferitelor tipuri de taxe\", \n       subtitle=\"Media 2018-2021\")\n\n\n\n\n\nObservăm că taxarea pe capital, proprietate şi muncă sunt corelate pozitiv şi invers corelate fiecare în mod negativ cu taxarea pe consum. Contribuţiile sunt relativ puţin corelate cu restul variabilelor. România se află împreună cu statele est-europene şi baltice în zona taxelor care taxează mai degrabă consumul decât celelalte categorii. Mai jos, un tabel cu aceste valori pentru România.\n\n\nArată codul\ntaxari %>% filter(geo==\"Romania\",what==\"PIB\") %>% \n  select(-what, -geo) %>% gt::gt(rowname_col = \"time\") %>% \n  gt::fmt_number(2:6, decimals = 2) %>% \n  gt::tab_header(title=\"România - % din PIB pentru diferite taxe\", \n                 subtitle = \"Sursa: Taxation Trends in European Union\") %>%\n  gtExtras::gt_theme_538() %>%\n  gt::opt_table_font(font=\"Frutiger\") %>%\n  gt::tab_style(style=gt::cell_fill(color=culori[1]), \n                locations = gt::cells_column_labels()) %>% \n  gt::tab_style(style=gt::cell_text(color=\"white\"), \n                locations=gt::cells_column_labels()) %>% \n  gt::tab_style(style=gt::cell_fill(color=culori[3], alpha=0.3), \n                locations=gt::cells_body()) %>% \n  gt::tab_options(table.border.left.color = \"#000000\") %>%\n  gt::tab_style(style=gt::cell_fill(color=culori[1], alpha=0.5), \n                locations=cells_row_groups()) %>%\n  gtExtras::gt_color_rows(columns=2:6) %>%\n  gt::tab_style(cell_text(font=\"Frutiger Bold\"), cells_title(groups='title')) %>%\n  gt::fmt_percent(columns=2:6, scale_values = FALSE)\n\n\n\n\n\n\n  \n    \n      România - % din PIB pentru diferite taxe\n    \n    \n      Sursa: Taxation Trends in European Union\n    \n    \n      \n      capital\n      contributii\n      munca\n      consum\n      proprietate\n    \n  \n  \n    2009\n4.40%\n8.96%\n11.13%\n9.70%\n0.75%\n    2010\n4.00%\n8.47%\n10.76%\n11.06%\n0.82%\n    2011\n4.41%\n8.65%\n10.62%\n11.94%\n0.78%\n    2012\n3.92%\n8.36%\n10.60%\n12.06%\n0.83%\n    2013\n4.19%\n8.68%\n11.06%\n12.27%\n0.89%\n    2014\n4.80%\n8.52%\n10.76%\n11.96%\n0.89%\n    2015\n5.13%\n8.08%\n10.30%\n12.62%\n0.86%\n    2016\n5.17%\n8.14%\n10.19%\n10.94%\n0.83%\n    2017\n4.32%\n8.51%\n10.78%\n9.99%\n0.72%\n    2018\n3.66%\n10.48%\n12.10%\n10.03%\n0.62%\n    2019\n3.84%\n10.48%\n11.98%\n10.11%\n0.62%\n    2020\n3.30%\n11.02%\n12.83%\n9.94%\n0.59%\n    2021\n4.04%\n10.52%\n12.10%\n10.38%\n0.63%"
  },
  {
    "objectID": "tranzactii_imobiliare.html",
    "href": "tranzactii_imobiliare.html",
    "title": "6  Tranzacţiile imobiliare",
    "section": "",
    "text": "Arată codul\nlibrary(tidyverse)\nlibrary(gt)\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#000000\", \"#0865a4\", \"#a48408\")\n\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\n\nx <- list.files(\"database/tranzactii_imobiliare\") %>%\nhere::here(\"database/tranzactii_imobiliare\", .) %>%\n  map_dfr(., ~readxl::read_xlsx(.x, skip = 1) %>% \n              select(2, 8) %>% drop_na()) %>% janitor::clean_names() %>%\n  group_by(judet) %>% summarise(total = sum(total_imobile)) %>% ungroup() %>%\n  filter(judet != \"TOTAL\")\n\nx %>% mutate(judet = fct_reorder(judet, total)) %>% \n  ggplot(aes(x=judet, y=total)) + \n  geom_col(fill=culori[1]) + coord_flip() + \n  scale_y_continuous(labels = scales::number_format(big.mark = \",\")) + \n  labs(title=\"Număr tranzacţii imobiliare\", subtitle=\"Anul 2022\")"
  },
  {
    "objectID": "calcule_finale.html",
    "href": "calcule_finale.html",
    "title": "7  Calcule finale şi simulări venituri la buget",
    "section": "",
    "text": "În această secţiune adunăm ce am calculat şi anterior înglobând şi simulări asupra impozitelor pe dividende. Din lipsă de date vom simula doar ce s-ar întâmpla dacă ar fi taxate doar dividendele de pe Bursa de Valori Bucureşti. Vom compara suma obţinută cu impozitul încasat de facto de bugetul statului pentru a ne face o idee dacă dividendele companiilor listate sunt majoritare în economie sau nu."
  },
  {
    "objectID": "calcule_finale.html#impozitul-pe-dividendele-companiilor-listate",
    "href": "calcule_finale.html#impozitul-pe-dividendele-companiilor-listate",
    "title": "7  Calcule finale şi simulări venituri la buget",
    "section": "7.1 Impozitul pe dividendele companiilor listate",
    "text": "7.1 Impozitul pe dividendele companiilor listate\nImpozitul din venitul pe dividende în 2021 a fost de circa 2.596 miliarde de RON, puţin mai mic de 10 % din totalul impozitului pe venitul personal. Pe anul 2021 a fost în efect rata de impozitare de 5 %.\n\n\nArată codul\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(gt)\n\n\nculori <- c(\"#EA5B0C\", \"#a44a08\", \"#ea960c\", \"#ea150c\", \n            \"#a40e08\", \"#000000\", \"#0865a4\", \"#a48408\")\n\n\ntheme_set(hrbrthemes::theme_ipsum_tw(strip_text_size = 14, \n                                     strip_text_family = \"Frutiger Bold\",\n                                     strip_text_face = \"italic\",\n                                     axis_title_size = 10,\n                                     axis_text_size = 8,\n                                     base_family = \"Frutiger\",\n                                     plot_title_family = \"Frutiger Bold\",\n                                     subtitle_family = \"Frutiger\",\n                                     caption_family = \"Frutiger\", \n                                     caption_size = 8,\n                                     plot_title_size = 14,\n                                     subtitle_size = 10) +\n  theme(legend.text = element_text(size=8), \n        legend.title = element_text(size=10),\n        legend.key.size = unit(0.5, \"cm\")))\n\n\nread_html(\"https://m.bvb.ro/FinancialInstruments/CorporateActions/InfoDividend\") %>% html_table(header=TRUE) %>% .[[1]] %>% \n  select(-1) %>% select(1, Year, `Dividends Total`) %>% \n  mutate(`Dividends Total` = parse_number(`Dividends Total`)) %>% \n  group_by(Year) %>% \n  summarise(total = sum(`Dividends Total`, na.rm=TRUE)) %>% \n  mutate(impozit = total*0.05) %>% \n  rename(An=Year, Dividende=total, Impozit=impozit) %>% \n  gt::gt(rowname_col = \"An\") %>%\n  gt::fmt_number(columns=2:3, sep_mark = \",\", decimals = 0) %>%\n  gt::cols_width(~\"150px\")\n\n\n\n\n\n\n  \n    \n    \n    \n  \n  \n    \n    \n      \n      Dividende\n      Impozit\n    \n  \n  \n    2020\n7,268,947,616\n363,447,381\n    2021\n7,801,037,517\n390,051,876\n    2022\n8,665,810,464\n433,290,523\n  \n  \n  \n\n\n\n\nDe unde deducem că în anul 2021 dividendele companiilor listate nu au constituit decât circa 15 % din totalul dividendelor extrase din economie. Dorim să propunem un impozit pe dividende de circa 18 %, fapt care ar aduce proporţional de 3.6 ori mai mulţi bani decât cei 2.6 miliarde de RON, adică încă 6.76 miliarde de RON. Desigur, acest estimat este puternic simplificat şi e în cel mai bun caz un maximum teoretic, dependent desigur şi de fluctuaţiile pieţei şi economiei. Vom merge cu un estimat conservator de 6 miliarde notând că în 2023 suma colectată va fi semnificativ mai mare (cum şi în 2022 dividendele totale au crescut cu circa 10 %)."
  },
  {
    "objectID": "calcule_finale.html#o-încercare-de-impozit-pe-averi",
    "href": "calcule_finale.html#o-încercare-de-impozit-pe-averi",
    "title": "7  Calcule finale şi simulări venituri la buget",
    "section": "7.2 O încercare de impozit pe averi",
    "text": "7.2 O încercare de impozit pe averi\nPutem simula pe baza datelor de la World Inequality Database şi o încercare de impozit pe marile averi. Dar vom avea nevoie de un cadru legislativ pentru acest lucru şi un ANAF performant.\n\n\nArată codul\nw <- read_delim(here::here('database', \"WID\", \"WID_data_RO.csv\"), delim=\";\") %>%  filter(variable==\"ahwealj992\") %>% select(-variable) %>% \n     select(-country) %>%\n     select(percentile, year, value)\n\npe <- numeric(100)\nfor(i in 1:100){\n  pe[i] <- paste0(\"p\", i-1, \"p\", i)\n}\n\nw <- w %>% filter(year>2016) %>% \n     group_by(percentile) %>% summarise(value=mean(value)) \n\nw %>% filter(grepl(\"^p[9]{2}\\\\.?[0-9]?p\", percentile)) %>% \n  filter(grepl(\"p100$\", percentile)) %>% arrange(value) %>% \n  rename(percentila=percentile, `Avere medie`=value) %>% \n  gt::gt() %>% \n  gtExtras::gt_theme_538() %>% \n  gt::fmt_number(columns=2, suffixing = T) %>% \n  opt_row_striping() %>% \n  gt::opt_table_font(font=\"Frutiger\") %>%\n  tab_header(title=\"Averea în cadrul top 1 % din populaţie\", \n             subtitle=\"Sursa: World Inequality Database\") %>%\n  tab_style(style=cell_fill(color=culori[1]), \n            locations=cells_column_labels()) %>% \n  tab_style(style=cell_text(color='white'), \n            locations=cells_column_labels())\n\n\n\n\n\n\n  \n    \n      Averea în cadrul top 1 % din populaţie\n    \n    \n      Sursa: World Inequality Database\n    \n    \n      percentila\n      Avere medie\n    \n  \n  \n    p99p100\n4.08M\n    p99.1p100\n4.35M\n    p99.2p100\n4.66M\n    p99.3p100\n5.05M\n    p99.4p100\n5.53M\n    p99.5p100\n6.17M\n    p99.6p100\n7.06M\n    p99.7p100\n8.42M\n    p99.8p100\n10.82M\n    p99.9p100\n16.82M\n  \n  \n  \n\n\n\n\nDoar la o primă vedere cu o taxă marginală de 1 % pe averile celor din top 1 % s-ar aduna, considerând o populaţie de 10 milioane de adulţi (conservator), circa 4 miliarde de RON. S-ar aplica celor care au averi de peste 4 milioane de RON. Calcul trebuie privit cu multă suspiciune, e doar o estimare grosieră."
  },
  {
    "objectID": "calcule_finale.html#simulări-finale",
    "href": "calcule_finale.html#simulări-finale",
    "title": "7  Calcule finale şi simulări venituri la buget",
    "section": "7.3 Simulări finale",
    "text": "7.3 Simulări finale\n\n\n\nArată codul\ninsumari <- read_csv(here::here(\"database\", \n                                \"taxe_sectoriale_scutiri.csv\")) %>%\n  mutate(sector=str_to_upper(sector)) %>%\n  group_by(sector) %>% summarise(valoare=sum(valoare)) %>%\n  rename(Masura = sector, Impact=valoare) %>%\n  bind_rows(tibble(\"Masura\"=c(\"Impozit progresiv pe venit\", \n                              \"Impozit pe dividende\", \n                              \"TRANZACŢII IMOBILIARE\", \n                              \"Coborâre prag microîntreprinderi\"),\n                   \"Impact\"=c(15, 6, 0.35, 2.5))) %>%\n  mutate(sector = c(\"Eliminare scutiri\", \"Eliminare scutiri\", \"Taxe sectoriale\", \"Eliminare scutiri\", \"Taxe sectoriale\", \"Taxe sectoriale\", \"Creştere impozite\", \"Creştere impozite\", \"Taxe sectoriale\", \"Creştere impozite\")) %>% \n  relocate(sector) \n\ntabel_total <- insumari %>%\ngt::gt(groupname_col = \"sector\") %>% \n  gt::fmt_number(columns=3, decimals = 2) %>% \ntab_header(title=\"Impact tipuri de măsuri propuse (miliarde RON)\", \n             subtitle=\"Calcule proprii pe bilanţurile anilor 2019-2021\") %>%\n  summary_rows(columns=3, fns=list(`TOTAL GRUP`=~sum(., na.rm=TRUE)), \n               fmt = ~fmt_number(.,decimals=2)) %>%\n  grand_summary_rows(columns=3, fns=list(TOTAL =~ sum(., na.rm=TRUE)), \n                     fmt=~fmt_number(., decimals=2)) %>%\n  gt::grand_summary_rows(columns=3, fns=list(TOTAL = ~sum(., na.rm=TRUE)), \n                         fmt = ~fmt_number(., decimals = 2)) %>%\n  tab_style(style=cell_fill(color=culori[3]), locations = cells_row_groups()) %>%\n  tab_style(style=cell_borders(color=culori[3]), locations=cells_row_groups()) %>%\n  tab_style(style=cell_text(font = \"Frutiger Bold\"), \n            locations=cells_row_groups()) %>%\n  tab_style(style=cell_fill(color=culori[5]), locations=cells_column_labels()) %>%\n  tab_style(style=cell_text(color='#fff'), locations=cells_column_labels()) %>%\n  tab_style(style=cell_fill(color=culori[5]), locations=cells_stubhead()) %>%\n  tab_style(style=cell_fill(color=culori[5]), locations=cells_grand_summary()) %>%\n  tab_style(style=cell_fill(color=culori[3], alpha=0.5), \n            locations=cells_summary()) %>%\n  tab_style(style=cell_text(color=\"#fff\"), \n            locations=cells_grand_summary()) %>%\n  gt::tab_options(container.width = \"90%\", table.layout = \"auto\", \n                  table.align = \"center\", \n                  table.additional_css = \"table.gt_table {border: 2px solid black;}\", footnotes.padding = 1) %>%\n  gt::tab_footnote(footnote=\"10 % taxă pe tranzacţiile imobiliare\",\n                   locations=cells_body(columns=Masura, \n                                      rows=grepl(\"IMOBILIARE\", Masura))) %>%\n  gt::tab_footnote(footnote=\"1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON\", locations = cells_body(columns=Masura, rows=grepl(\"ENERGIE\", Masura))) %>%\n  gt::tab_footnote(footnote = \"1.2 % impozit pe cifra de afaceri pentru toate firmele\",\n                   locations=cells_body(columns=Masura, \n                                        rows=grepl(\"JOCURI\", Masura))) %>%\n  gt::tab_footnote(footnote=\"1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON\", locations=cells_body(columns=Masura, \n                                          rows=grepl(\"RETAIL\", Masura))) %>%\n  gt::tab_footnote(footnote = \"Cote de 10%, 16 % şi 21 % pentru ce trece de 600, respectiv 2200 EURO lunar brut\", \n                   locations=cells_body(columns=Masura, \n                                        rows=grepl(\"venit\", Masura))) %>%\n  gt::tab_footnote(footnote=\"Impozit pe dividende de 18 %\", \n                   locations=cells_body(columns=Masura, \n                                        rows=grepl(\"dividende\", Masura))) %>%\n  gt::tab_footnote(footnote=\"Scăderea pragului de venit al microîntreprinderii la 250.000 EURO\", \n                   locations=cells_body(columns=Masura, rows=grepl(\"prag\", Masura))) %>% \n  gt::tab_footnote(footnote = \"Mai probabilă este estimarea MF de 0.9 miliarde RON\", locations=cells_body(columns=Impact, \n                                    rows=grepl(\"IT\", Masura))) %>% \n  gtExtras::gt_theme_538() %>%\n  gt::opt_table_font(font=\"Frutiger\") %>%\n  gt::tab_style(style=cell_text(font=\"Frutiger Bold\"), \n                locations=cells_summary()) %>%\n  gt::tab_style(style=cell_text(font=\"Frutiger Bold\"), \n                locations=cells_grand_summary()) %>%\n    gt::tab_style(style=cell_text(size = px(12)), locations=cells_body()) %>%\n    gt::tab_style(style=cell_text(size=px(14), font = \"Frutiger Bold\"),\n                  locations=cells_summary()) %>% \n    gt::tab_style(style=cell_text(size=px(12)), \n                  locations=cells_footnotes()) %>%\n    gt::tab_style(cell_text(font=\"Frutiger Bold\"), \n                  cells_title(groups=\"title\"))\n\ntabel_total |> gt::as_raw_html()\n\n\n\n\n  \n  \n  \n    \n      Impact tipuri de măsuri propuse (miliarde RON)\n    \n    \n      Calcule proprii pe bilanţurile anilor 2019-2021\n    \n    \n      \n      Masura\n      Impact\n    \n  \n  \n    \n      Eliminare scutiri\n    \n    \nALIMENTAR & AGRICULTURA\n2.08\n    \nCONSTRUCŢII\n5.46\n    \nIT\n1 1.99\n    TOTAL GRUP\n—\n9.53\n    \n      Taxe sectoriale\n    \n    \nENERGIE2\n0.86\n    \nJOCURI DE NOROC3\n0.11\n    \nRETAIL4\n4.18\n    \nTRANZACŢII IMOBILIARE5\n0.35\n    TOTAL GRUP\n—\n5.49\n    \n      Creştere impozite\n    \n    \nImpozit progresiv pe venit6\n15.00\n    \nImpozit pe dividende7\n6.00\n    \nCoborâre prag microîntreprinderi8\n2.50\n    TOTAL GRUP\n—\n23.50\n    TOTAL\n—\n38.52\n  \n  \n  \n    \n      1 Mai probabilă este estimarea MF de 0.9 miliarde RON\n    \n    \n      2 1.2 % impozit pe cifra de afaceri netă ce depăşeşte 1 miliard RON\n    \n    \n      3 1.2 % impozit pe cifra de afaceri pentru toate firmele\n    \n    \n      4 1.2 % impozit pe cifra de afaceri ce depăşeşte 100 de milioane RON\n    \n    \n      5 10 % taxă pe tranzacţiile imobiliare\n    \n    \n      6 Cote de 10%, 16 % şi 21 % pentru ce trece de 600, respectiv 2200 EURO lunar brut\n    \n    \n      7 Impozit pe dividende de 18 %\n    \n    \n      8 Scăderea pragului de venit al microîntreprinderii la 250.000 EURO\n    \n  \n\n\n\n\n\nŞi acum sub formă de pie chart.\n\n\nArată codul\ninsumari %>% \n  mutate(Masura = fct_lump(Masura, n=7, w = Impact)) %>% \n  group_by(sector, Masura) %>% \n  summarise(Impact = sum(Impact)) %>% \n  mutate(Masura = gsub(\"Other\", \"Altele\", Masura)) %>% ungroup() %>%\n  mutate(index = c(3, 5, 6, 1, 4, 7, 8, 2)) %>%\n  arrange(desc(index)) %>%\n  mutate(procent = 100*Impact/sum(Impact), \n         ypos=cumsum(procent)-0.5*procent,\n         eticheta = paste0(round(procent, 2), \" %\")) %>%\n  ggplot(aes(x = 1.8, y = procent, fill = Masura)) +\n  geom_bar(stat = \"identity\", color = \"white\") +\n  coord_polar(theta=\"y\", start = 0, direction=1)+\n  geomtextpath::geom_textpath(aes(y = ypos, \n                                  label = eticheta), color = \"white\")+\n  scale_fill_manual(values=c(\"#0073C2FF\", \"#868686FF\", \"#CD534CFF\", \"seagreen4\", \"red3\", \"royalblue4\", culori[1], \"purple4\")) +\n  theme_void() +\n  xlim(0.5, 2.5) +\n  theme(legend.margin = margin(l=-0.5, unit=\"cm\"))\n\n\n\n\n\n\n\nArată codul\ninsumari %>% \n  mutate(procent = 100*Impact/sum(Impact)) %>%\n  group_by(sector) %>%\n  summarise(Impact=sum(Impact), procent=sum(procent)) %>% \n  ungroup() %>% arrange(desc(sector)) %>%\n  mutate(ypos=cumsum(procent)-0.5*procent,\n         eticheta = paste0(round(procent, 2), \" %\", \"\\n\", \"(\", round(Impact,2), \")\")) %>%\n  ggplot(aes(x = 1.8, y = procent, fill = sector)) +\n  geom_bar(stat = \"identity\", color = \"white\") +\n  coord_polar(theta=\"y\", start = 0, direction=1)+\n  geomtextpath::geom_textpath(aes(y = ypos, \n                                  label = eticheta), size=4, color = \"white\")+\n  scale_fill_manual(values=c(culori[1], culori[5], culori[8])) +\n  theme_void() +\n  xlim(0.5, 2.5) +\n  theme(legend.margin = margin(l=-0.5, unit=\"cm\"))\n\n\n\n\n\nImportant de menţionat, în cazul în care se optează pentru implementarea unui credit fiscal pentru ultimii 10 % ai distribuţiei veniturilor (< 100 euro brut lunar), suma totală mai scade cu 2.5 miliarde RON."
  }
]